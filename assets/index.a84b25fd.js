var ht=Object.defineProperty,pt=Object.defineProperties;var mt=Object.getOwnPropertyDescriptors;var st=Object.getOwnPropertySymbols;var gt=Object.prototype.hasOwnProperty,ft=Object.prototype.propertyIsEnumerable;var Z=(r,t,n)=>t in r?ht(r,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[t]=n,j=(r,t)=>{for(var n in t||(t={}))gt.call(t,n)&&Z(r,n,t[n]);if(st)for(var n of st(t))ft.call(t,n)&&Z(r,n,t[n]);return r},N=(r,t)=>pt(r,mt(t));var x=(r,t,n)=>(Z(r,typeof t!="symbol"?t+"":t,n),n);import{M as B,Q as _t,o as l,c as d,a as e,w as m,v as R,t as p,b as y,d as f,n as I,e as T,f as w,F as $,r as F,g as W,h as u,P as bt,i as v,j as D,p as yt,k as wt,u as X,l as vt,m as nt,q as A,s as O,T as kt,x as ot,y as it,z as xt,A as St,B as Dt}from"./vendor.83d598fe.js";const Ct=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}};Ct();let J="fetch"in globalThis?fetch:require("isomorphic-fetch");class z{constructor(t){x(this,"syncId","");x(this,"password","");x(this,"server","");x(this,"hasCredentials",!1);x(this,"lastUpdated",null);x(this,"storage");x(this,"serverList",[{url:"https://api.xbrowsersync.org",location:"United Kingdom",storage:"1MB"},{url:"https://xbrowsersync.freerangecloud.com",location:"Canada",storage:"9.77MB"},{url:"https://sync.adminforge.de",location:"Germany",storage:"4.88MB"},{url:"https://xbrowsersync.servicesforfree.com",location:"Germany",storage:"20MB"},{url:"https://xbs.eris.cc",location:"Germany",storage:"5MB"},{url:"https://xbsapi.cgrx.de",location:"Germany",storage:"9.77MB"},{url:"https://xsync.nixnet.services",location:"Germany",storage:"10MB"},{url:"https://xbs.25mb.co.uk",location:"United Kingdom",storage:"1MB"},{url:"https://xbs.andrewkdinh.com",location:"United States",storage:"1MB"}]);this.storage=t;const n=this.storage.get("credentials");n&&(this.syncId=n.syncId,this.password=n.password,this.server=n.server,this.hasCredentials=!0);const a=this.storage.get("lastUpdated");a&&(this.lastUpdated=new Date(a))}getCryptoImpl(){return window.crypto.subtle}getRandomValues(t){return window.crypto.getRandomValues(t)}generateNewSyncId(t){return t=t.replace(/\/+$/,""),J(t+"/bookmarks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({version:"1.1.13"})}).then(n=>n.json())}setCredentials(t,n,a,s){this.server=t.replace(/\/+$/,""),this.syncId=n,this.password=a,this.hasCredentials=!0,s&&this.storeCredentials()}forgetCredentials(){this.password="",this.server="",this.syncId="",this.storage.remove("credentials"),this.hasCredentials=!1}getCredentials(){return{password:this.password,server:this.server,syncId:this.syncId}}async getLastUpdated(t=!0){return J(`${this.server}/bookmarks/${this.syncId}/lastUpdated`,{headers:{"Content-Type":"application/json"}}).then(n=>n.json()).then(n=>{if(n.message)return{error:!0,message:n.message};const a=new Date(n.lastUpdated);return t&&this.setLastUpdated(a),a})}setLastUpdated(t){this.lastUpdated=t,this.storage.set("lastUpdated",this.lastUpdated.toISOString())}storeCredentials(){this.storage.set("credentials",{syncId:this.syncId,password:this.password,server:this.server})}async needsUpdate(){return this.getLastUpdated(!1).then(t=>{if("error"in t)throw new Error(t.message);return+this.lastUpdated!=+t})}async load(){const t=await J(`${this.server}/bookmarks/${this.syncId}`,{headers:{"Content-Type":"application/json"}}).then(s=>s.json());if(!("bookmarks"in t))return!1;"lastUpdated"in t&&this.setLastUpdated(new Date(t.lastUpdated));const n=await this.decryptData(t.bookmarks,this.password,!1);let a=await this.decompress(n);return JSON.parse(a)}async store(t){const n=JSON.stringify(t);if(this.hasCredentials){const a=await this.compress(n),s=await this.encryptData(a,this.password);return J(this.server+"/bookmarks/"+this.syncId,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({bookmarks:s})}).then(o=>o.json()).then(o=>{if("message"in o){console.log("whaty fucky");return}return this.setLastUpdated(new Date(o.lastUpdated)),{original:n.length,compressed:a.byteLength,encrypted:s.length}})}return null}async compress(t,n="deflate"){const a=new TextEncoder().encode(t),s=new CompressionStream(n),o=s.writable.getWriter();return o.ready.then(()=>o.write(a)).catch(i=>console.error("Chunk error:",i)),o.ready.then(()=>o.close()).catch(i=>console.error("Stream error:",i)),new Response(s.readable).arrayBuffer()}async decompress(t,n="deflate"){const a=new DecompressionStream("deflate"),s=a.writable.getWriter();return s.write(t),s.close(),new Response(a.readable).arrayBuffer().then(function(o){return new TextDecoder().decode(o)})}buff_to_base64(t){return btoa(String.fromCharCode.apply(null,t))}base64_to_buf(t){return Uint8Array.from(atob(t),n=>n.charCodeAt(null))}getPasswordKey(t){return this.getCryptoImpl().importKey("raw",new TextEncoder().encode(t),"PBKDF2",!1,["deriveKey"])}deriveKey(t,n,a){return this.getCryptoImpl().deriveKey({name:"PBKDF2",salt:n,iterations:25e4,hash:"SHA-256"},t,{name:"AES-GCM",length:256},!1,a)}async encryptData(t,n){try{const a=this.getRandomValues(new Uint8Array(16)),s=this.getRandomValues(new Uint8Array(12)),o=await this.getPasswordKey(n),i=await this.deriveKey(o,a,["encrypt"]),c=await this.getCryptoImpl().encrypt({name:"AES-GCM",iv:s},i,typeof t=="string"?new TextEncoder().encode(t):t),h=new Uint8Array(c),_=new Uint8Array(a.byteLength+s.byteLength+h.byteLength);return _.set(a,0),_.set(s,a.byteLength),_.set(h,a.byteLength+s.byteLength),this.buff_to_base64(_)}catch(a){return console.log(`Error - ${a}`),""}}async decryptData(t,n,a=!0){try{const s=this.base64_to_buf(t),o=s.slice(0,16),i=s.slice(16,16+12),c=s.slice(16+12),h=await this.getPasswordKey(n),_=await this.deriveKey(h,o,["decrypt"]),g=await this.getCryptoImpl().decrypt({name:"AES-GCM",iv:i},_,c);return a?new TextDecoder().decode(g):g}catch(s){return console.log(`Error - ${s}`),""}}async createConnectionStrings(t,n=!1){let a={cli:`tmlg --sync-setup --sync-enable --sync-server "${this.server}" --sync-id "${this.syncId}" --sync`};return n&&(a.cli+=` --sync-password "${this.password}"`),t&&typeof t=="string"&&(a.url=await this.encryptData(JSON.stringify({syncId:this.syncId,server:this.server}),this.password).then(s=>{const o=new URL(t);return o.searchParams.set("encryptedSyncCredentials",s),n&&o.searchParams.set("password",btoa(this.password)),o.toString()})),a}}var k=(r,t)=>{const n=r.__vccOpts||r;for(const[a,s]of t)n[a]=s;return n};const Tt={inject:["util","globalStore","settings"],name:"SyncOptionsDialog",props:{sync:z},data(){return{modal:!1,loginError:!1,includePasswordInQRCode:!1,syncId:null,server:"",passwordType:"password",registerError:null,password:"",passwordRepeat:"",passwordValid:!1,passwordRepeatValid:!1,syncURL:null,syncCLICommand:null,view:"status",hasCompressionStream:"CompressionStream"in window,hasDecompressionStream:"DecompressionStream"in window,hasCrypto:"crypto"in window,hasCryptoSubtle:"crypto"in window&&"subtle"in window.crypto}},watch:{password(r){this.passwordValid=r.length>7,this.passwordRepeatValid=this.password===this.passwordRepeat},passwordRepeat(){this.passwordRepeatValid=this.password===this.passwordRepeat},includePasswordInQRCode(){this.createQRCode()}},mounted(){this.modal=new B(this.$refs.modal),this.$refs.modal.addEventListener("show.bs.modal",r=>{this.server=this.sync.server||this.sync.serverList[0].url}),this.$refs.modal.addEventListener("hidden.bs.modal",r=>{this.server=null,this.view="status",this.passwordType="password",this.registerError=null,this.password="",this.passwordRepeat="",this.passwordValid=!1,this.passwordRepeatValid=!1})},methods:{show(){this.modal.show()},attemptLogin(){this.globalStore.setLoading(!0),this.sync.setCredentials(this.server,this.syncId,this.password),this.sync.getLastUpdated().then(r=>{if(this.globalStore.setLoading(!1),"error"in r){this.loginError=`Error: ${r.message}`;return}this.sync.storeCredentials(),this.globalStore.toast("sync","login successful")})},showSyncURL(){this.view="showSyncURL",this.createQRCode()},createQRCode(){this.sync.createConnectionStrings(window.location.toString(),this.includePasswordInQRCode).then(r=>{this.syncCLICommand=r.cli,this.syncURL=r.url,console.log({r}),this.$refs.qrcode.querySelector("canvas")&&this.$refs.qrcode.querySelector("canvas").remove(),new _t(this.$refs.qrcode,{text:this.syncURL,quietZone:40,width:600,height:600,onRenderingEnd:()=>{this.$refs.qrcode.querySelector("canvas").classList.add("img-fluid","d-block"),this.$refs.qrcode.querySelector("canvas").style.setProperty("image-rendering","pixelated")}})})},registerSyncId(){this.globalStore.setLoading(!0),this.view="register",this.sync.generateNewSyncId(this.server).then(r=>{this.globalStore.setLoading(!1),"code"in r&&/exception/i.test(r.code)?(this.view="registerError",this.registerError=r.message):this.syncId=r.id}).catch(r=>{this.globalStore.setLoading(!1),this.view="registerError",this.registerError=r.message})},setSyncCredentials(){this.sync.setCredentials(this.server,this.syncId,this.password),this.sync.getLastUpdated().then(r=>{if("error"in r){this.registerError=r.message,this.view="registerError";return}this.sync.storeCredentials(),this.modal.hide(),this.globalStore.toast("sync","Synchronization is connected!")})},forgetSyncCredentials(){if(!confirm("are you sure?"))return!1;this.settings.syncEnabled=!1,this.sync.forgetCredentials(),this.modal.hide(),this.globalStore.toast("sync","your credentials have been removed...")}}},It={class:"modal fade",ref:"modal",id:"syncSetup","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"syncSetupLabel","aria-hidden":"true"},$t={class:"modal-dialog modal-dialog-scrollable modal-fullscreen-md-down"},Lt={class:"modal-content"},Ft={class:"modal-header"},Rt={class:"modal-title fw-light",id:"syncSetupLabel"},Mt=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Et={class:"modal-body"},Ut={class:"row"},Pt={class:"col-12"},jt={key:0,class:"table table-sm"},Ot=e("th",{scope:"row"},"server",-1),Vt=e("th",{scope:"row"},"syncId",-1),At=e("th",{scope:"row"},"password",-1),Bt={class:"d-flex justify-content-between"},Ht={key:0},zt={key:1},Nt=e("th",{scope:"row"},"last updated",-1),qt={key:1},Yt={class:"list-group list-group-flush"},Kt={key:2},Qt=e("p",null," Sync is not available because wour browser doesn't support one or more of those features: ",-1),Jt={class:"table"},Wt=e("td",null,[e("code",null,"CompressionStream")],-1),Gt=e("td",null,[e("code",null,"DecompressionStream")],-1),Zt=e("td",null,[e("code",null,"Crypto")],-1),Xt=e("td",null,[e("code",null,"CryptoSubtle")],-1),te={class:"row"},ee={class:"col-12"},se={ref:"qrcode",id:"qrcode-wrap",class:"mw-100 mx-auto"},ne=e("label",{class:"form-check-label",for:"include_password"}," Include Password in URL ",-1),oe={class:"input-group mb-3"},ie=e("p",null," Open the URL on the device that you want to sync your timelogs on and enter your password when prompted. ",-1),re=e("hr",null,null,-1),ae=e("p",null," Use the command below to se tup a cli installation ",-1),le={class:"input-group mb-3"},de=e("p",null,[u(" Use "),e("code",null,"npm i tmlg -g"),u(" to install the app on your machine ")],-1),ce={class:"row"},ue={class:"col-12"},he={class:"mb-1"},pe=e("label",{for:"server",class:"form-label"},"Server",-1),me={id:"serverList"},ge=["value"],fe={class:"mb-1"},_e=e("label",{for:"login_syncId",class:"form-label"},"SyncId",-1),be={class:"mb-1"},ye=e("label",{for:"login_password",class:"form-label"},"Password",-1),we={class:"input-group"},ve=["type"],ke={key:0,class:"alert alert-warning"},xe={class:"d-flex justify-content-center mt-3"},Se=["disabled"],De={class:"row"},Ce={class:"col-12"},Te=e("p",null,"There was an error fetching a new sync id from the service:",-1),Ie={class:"row"},$e={class:"col-12"},Le={class:"mb-1"},Fe=e("label",{for:"serverURL",class:"form-label"},"API Server URL",-1),Re=e("p",{class:"my-1"}," Public servers ",-1),Me={class:"list-group list-group-flush mb-3"},Ee=["onClick"],Ue=e("br",null,null,-1),Pe={class:"d-flex justify-content-center"},je=["disabled"],Oe={class:"row"},Ve={class:"col-12"},Ae={class:"mb-1"},Be=e("label",{for:"serverURL",class:"form-label"},"Server",-1),He={class:"mb-1"},ze=e("label",{for:"syncId",class:"form-label"},"SyncId",-1),Ne={class:"mb-1"},qe=e("label",{for:"register_password",class:"form-label"},"Password",-1),Ye={class:"input-group"},Ke=["type"],Qe={class:"mb-1"},Je=e("label",{for:"password_repeat",class:"form-label"},"Repeat Password",-1),We={class:"input-group"},Ge=["type"],Ze=e("div",{class:"small mb-1"},[e("p",{class:"mb-2"},[u("Make sure you save the password in your browser or password manager, there is "),e("u",null,"no way"),u(" to recover it!")]),e("p",null,"The password will be stored as plain text in your browser, so use an unique password!")],-1),Xe={class:"d-flex justify-content-center"},ts=["disabled"];function es(r,t,n,a,s,o){return l(),d("div",It,[e("div",$t,[e("div",Lt,[e("div",Ft,[e("h5",Rt,[m(e("span",null,"Sync Info ",512),[[R,s.view==="status"&&n.sync.hasCredentials]]),m(e("span",null,"Synchronization ",512),[[R,s.view==="status"&&!n.sync.hasCredentials]]),m(e("span",null,"Login",512),[[R,s.view==="login"]]),m(e("span",null,"Register",512),[[R,s.view==="register"]]),m(e("span",null,"Registration failed",512),[[R,s.view==="registerError"]]),m(e("span",null,"Sync URL",512),[[R,s.view==="showSyncURL"]])]),Mt]),e("div",Et,[m(e("div",Ut,[e("div",Pt,[n.sync.hasCredentials?(l(),d("table",jt,[e("tbody",null,[e("tr",null,[Ot,e("td",null,[e("code",null,p(n.sync.server),1)])]),e("tr",null,[Vt,e("td",null,[e("code",null,p(n.sync.syncId),1)])]),e("tr",null,[At,e("td",null,[e("div",Bt,[s.passwordType==="password"?(l(),d("code",Ht,p(n.sync.password.replace(/./g,"*")),1)):(l(),d("code",zt,p(n.sync.password),1)),s.passwordType==="password"?(l(),d("a",{key:2,href:"#",onClick:t[0]||(t[0]=y(i=>s.passwordType="text",["stop","prevent"]))},"show")):f("",!0),s.passwordType==="text"?(l(),d("a",{key:3,href:"#",onClick:t[1]||(t[1]=y(i=>s.passwordType="password",["stop","prevent"]))},"hide")):f("",!0)])])]),e("tr",null,[Nt,e("td",null,[e("code",null,p(n.sync.lastUpdated?n.sync.lastUpdated.toLocaleString():"n/a"),1)])])])])):f("",!0),s.hasCompressionStream&&s.hasDecompressionStream&&s.hasCrypto&&s.hasCryptoSubtle?(l(),d("div",qt,[e("div",Yt,[n.sync.hasCredentials?f("",!0):(l(),d("button",{key:0,onClick:t[2]||(t[2]=i=>s.view="login"),type:"button",class:"list-group-item text-center list-group-item-action"}," connect with sync id and password ")),n.sync.hasCredentials?f("",!0):(l(),d("button",{key:1,onClick:t[3]||(t[3]=i=>s.view="serverSelect"),type:"button",class:"list-group-item text-center list-group-item-action"}," register new sync id and password ")),n.sync.hasCredentials?(l(),d("button",{key:2,onClick:t[4]||(t[4]=(...i)=>o.forgetSyncCredentials&&o.forgetSyncCredentials(...i)),type:"button",class:"list-group-item text-center list-group-item-action"}," remove currently stored credentials ")):f("",!0),n.sync.hasCredentials?(l(),d("button",{key:3,onClick:t[5]||(t[5]=(...i)=>o.showSyncURL&&o.showSyncURL(...i)),type:"button",class:"list-group-item text-center list-group-item-action"}," Connect other devices and platforms ")):f("",!0)])])):(l(),d("div",Kt,[Qt,e("table",Jt,[e("tr",null,[Wt,e("td",null,p(s.hasCompressionStream?"ok":"no"),1)]),e("tr",null,[Gt,e("td",null,p(s.hasDecompressionStream?"ok":"no"),1)]),e("tr",null,[Zt,e("td",null,p(s.hasCrypto?"ok":"no"),1)]),e("tr",null,[Xt,e("td",null,p(s.hasCryptoSubtle?"ok":"no"),1)])])]))])],512),[[R,s.view==="status"]]),m(e("div",te,[e("div",ee,[e("div",se,null,512),e("div",{class:I(["form-check form-switch my-2",{"text-warning":s.includePasswordInQRCode}])},[m(e("input",{class:"form-check-input setting",type:"checkbox",value:"",id:"include_password","onUpdate:modelValue":t[6]||(t[6]=i=>s.includePasswordInQRCode=i)},null,512),[[T,s.includePasswordInQRCode]]),ne],2),e("div",oe,[m(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[7]||(t[7]=i=>s.syncURL=i),readonly:""},null,512),[[w,s.syncURL]]),e("button",{class:"btn btn-outline-secondary",type:"button",onClick:t[8]||(t[8]=y(i=>{o.util.copyToClipboard(s.syncURL,r.$refs.qrcode),o.globalStore.toast("copied!")},["stop","prevent"]))},"copy ")]),ie,re,ae,e("div",le,[m(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[9]||(t[9]=i=>s.syncCLICommand=i),readonly:""},null,512),[[w,s.syncCLICommand]]),e("button",{class:"btn btn-outline-secondary",type:"button",onClick:t[10]||(t[10]=y(i=>{o.util.copyToClipboard(s.syncCLICommand,r.$refs.qrcode),o.globalStore.toast("copied!")},["stop","prevent"]))},"copy ")]),de])],512),[[R,s.view==="showSyncURL"]]),m(e("div",ce,[e("div",ue,[e("div",he,[pe,m(e("input",{class:"form-control",list:"serverList",id:"server",placeholder:"Type to search...","onUpdate:modelValue":t[11]||(t[11]=i=>s.server=i)},null,512),[[w,s.server]]),e("datalist",me,[(l(!0),d($,null,F(n.sync.serverList,i=>(l(),d("option",{value:i.url},null,8,ge))),256))])]),e("div",fe,[_e,m(e("input",{class:"form-control",id:"login_syncId","onUpdate:modelValue":t[12]||(t[12]=i=>s.syncId=i)},null,512),[[w,s.syncId]])]),e("div",be,[ye,e("div",we,[m(e("input",{class:"form-control",type:s.passwordType,autocomplete:"current-password",id:"login_password","onUpdate:modelValue":t[13]||(t[13]=i=>s.password=i)},null,8,ve),[[W,s.password]]),e("button",{class:"btn-outline-secondary btn",id:"passwordAddon",onClick:t[14]||(t[14]=i=>s.passwordType=s.passwordType==="password"?"text":"password")},p(s.passwordType==="password"?"show":"hide"),1)])]),s.loginError?(l(),d("div",ke,p(s.loginError),1)):f("",!0),e("div",xe,[e("button",{class:"btn btn-outline-primary",onClick:t[15]||(t[15]=(...i)=>o.attemptLogin&&o.attemptLogin(...i)),disabled:!s.server||!s.syncId||!s.password},"Login ",8,Se)])])],512),[[R,s.view==="login"]]),m(e("div",De,[e("div",Ce,[Te,e("p",null,[e("code",null,p(s.registerError),1)])])],512),[[R,s.view==="registerError"]]),m(e("div",Ie,[e("div",$e,[e("div",Le,[Fe,m(e("input",{class:"form-control",type:"url",id:"serverURL","onUpdate:modelValue":t[16]||(t[16]=i=>s.server=i)},null,512),[[w,s.server]]),Re,e("div",Me,[(l(!0),d($,null,F(n.sync.serverList,i=>(l(),d("button",{class:"list-group-item list-group-item-action",onClick:c=>s.server=i.url},[e("span",null,p(i.url),1),Ue,e("small",null,p(i.location+", "+i.storage),1)],8,Ee))),256))])]),e("div",Pe,[e("button",{class:"btn btn-outline-primary",onClick:t[17]||(t[17]=(...i)=>o.registerSyncId&&o.registerSyncId(...i)),disabled:!s.server},"Create Synchronization ",8,je)])])],512),[[R,s.view==="serverSelect"]]),m(e("div",Oe,[e("div",Ve,[e("div",Ae,[Be,m(e("input",{class:"form-control",disabled:"",id:"serverURL",readonly:"","onUpdate:modelValue":t[18]||(t[18]=i=>s.server=i)},null,512),[[w,s.server]])]),e("div",He,[ze,m(e("input",{class:"form-control",disabled:"",id:"syncId",readonly:"","onUpdate:modelValue":t[19]||(t[19]=i=>s.syncId=i)},null,512),[[w,s.syncId]])]),e("div",Ne,[qe,e("div",Ye,[m(e("input",{class:I([{"is-invalid":s.password&&!s.passwordValid,"is-valid":s.password&&s.passwordValid},"form-control"]),type:s.passwordType,autocomplete:"new-password",id:"register_password","onUpdate:modelValue":t[20]||(t[20]=i=>s.password=i)},null,10,Ke),[[W,s.password]]),e("button",{class:"btn-outline-secondary btn",id:"passwordAddon",onClick:t[21]||(t[21]=i=>s.passwordType=s.passwordType==="password"?"text":"password")},p(s.passwordType==="password"?"show":"hide"),1)])]),e("div",Qe,[Je,e("div",We,[m(e("input",{class:I(["form-control",{"is-invalid":s.passwordRepeat&&!s.passwordRepeatValid,"is-valid":s.passwordRepeat&&s.passwordRepeatValid}]),type:s.passwordType,autocomplete:"new-password",id:"passwordRepeat","onUpdate:modelValue":t[22]||(t[22]=i=>s.passwordRepeat=i)},null,10,Ge),[[W,s.passwordRepeat]]),e("button",{class:"btn-outline-secondary btn",id:"passwordRepeatAddon",onClick:t[23]||(t[23]=i=>s.passwordType=s.passwordType==="password"?"text":"password")},p(s.passwordType==="password"?"show":"hide"),1)])]),Ze,e("div",Xe,[e("button",{class:"btn btn-outline-primary",onClick:t[24]||(t[24]=(...i)=>o.setSyncCredentials&&o.setSyncCredentials(...i)),disabled:!s.passwordValid||!s.passwordRepeatValid},"Create Synchronization ",8,ts)])])],512),[[R,s.view==="register"]])])])])],512)}var ss=k(Tt,[["render",es]]);const ns={inject:["util","globalStore","settings"],props:{sync:z},data(){return{modal:null,currencyIsValid:!0,dateFormatIsValid:!0,dateRangeFormatIsValid:!0,currentTab:"input"}},mounted(){this.modal=new B(this.$refs.modal),Array.from(this.$refs.modal.querySelectorAll('[data-bs-toggle="popover"]')).forEach(r=>{new bt(r,{trigger:"focus"})})},watch:{settings:{deep:!0,handler:function(r,t){this.checkValidity(),this.settings.defaultClient=this.settings.defaultClient.replace(/[@%\/#:+]/g,""),this.settings.defaultProject=this.settings.defaultProject.replace(/[@%\/#:+]/g,""),this.settings.defaultTask=this.settings.defaultTask.replace(/[@%\/#:+]/g,""),this.settings.defaultSource=this.settings.defaultSource.replace(/[@%\/#:+]/g,""),this.settings.syncEnabled&&this.$emit("enable-sync")}}},methods:{checkValidity(){const r=this.settings.dateFormat,t=this.settings.dateRangeFormat;this.currencyIsValid=/%s/.test(this.settings.currencyFormat)&&!/^%s$/.test(this.settings.currencyFormat.trim())&&this.settings.currencyFormat!=="",this.dateFormatIsValid=r.match(/d/g).length===2&&r.match(/m/g).length===2&&r.match(/y/g).length===4,this.dateRangeFormatIsValid=t.match(/dd/g).length===2&&t.match(/mm/g).length===2&&t.match(/yyyy/g).length===2},show(){this.modal.show()},saveSettings(){this.globalStore.toast("settings saved"),this.settings.syncSettings&&this.$emit("store"),this.modal.hide()}}},os={class:"modal fade",ref:"modal",id:"settings","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"settingsLabel","aria-hidden":"true"},is={class:"modal-dialog modal-dialog-scrollable modal-fullscreen-md-down modal-lg"},rs={class:"modal-content"},as=e("div",{class:"modal-header"},[e("h5",{class:"modal-title fw-light",id:"settingsLabel"},"Settings"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ls={class:"modal-body"},ds={class:"nav nav-tabs mb-4"},cs={class:"nav-item"},us={class:"nav-item"},hs=e("span",{class:"d-none d-lg-inline"},"Synchronization",-1),ps=e("span",{class:"d-lg-none"},"Sync",-1),ms=[hs,ps],gs={class:"nav-item"},fs=e("span",{class:"d-none d-lg-inline"},"Timelogs",-1),_s=e("span",{class:"d-lg-none"},"Logs",-1),bs=[fs,_s],ys={class:"nav-item"},ws={class:"nav-item"},vs={class:"form-check form-switch mb-4"},ks=e("label",{class:"form-check-label",for:"storeOnControlEnter"},[u(" store on "),e("kbd",null,"ctrl"),u("+"),e("kbd",null,"enter"),u(" ("),e("kbd",null,"cmd"),u("+"),e("kbd",null,"enter"),u(") ")],-1),xs={class:"form-check form-switch mb-4"},Ss=e("label",{class:"form-check-label",for:"clearTimeLogOnStore"}," clear timelog on store ",-1),Ds={class:"form-check form-switch mb-4"},Cs=e("label",{class:"form-check-label",for:"showParsePreviewOnType"}," show parsed data while typing ",-1),Ts={class:"form-check form-switch mb-4"},Is=e("label",{class:"form-check-label",for:"showHelpIcon"}," show help icon ",-1),$s={class:"form-check form-switch mb-4"},Ls=e("label",{class:"form-check-label",for:"defaultDateInsideSelection"}," default date always in range ",-1),Fs=e("p",{class:"small"},[u("When "),e("code",null,":date"),u(" is omitted in timelogs and selected range does not cover current date, log is created inside the selected range")],-1),Rs={key:0,class:"small"},Ms={class:"form-check form-switch mb-4"},Es=["disabled"],Us=e("label",{class:"form-check-label",for:"syncEnabled"}," sync enabled ",-1),Ps={class:"form-check form-switch mb-4"},js=["disabled"],Os=e("label",{class:"form-check-label",for:"syncSettings"}," sync settings ",-1),Vs={class:"form-check form-switch mb-4"},As=["disabled"],Bs=e("label",{class:"form-check-label",for:"syncOnLoad"}," sync on load ",-1),Hs={class:"mb-4"},zs=e("label",{for:"syncAfterSeconds",class:"form-label mb-0"},"seconds to wait after log insert before sync (0=off):",-1),Ns={class:"row g-1"},qs={class:"col-2"},Ys=["disabled"],Ks={class:"col-10 pt-1"},Qs=["disabled"],Js={class:"mb-4"},Ws=e("label",{for:"checkForUpdateIntervalMinutes",class:"form-label mb-0"},"sync interval minutes (0=off):",-1),Gs={class:"row g-1"},Zs={class:"col-2"},Xs=["disabled"],tn={class:"col-10 pt-1"},en=["disabled"],sn={class:"mb-4"},nn=e("label",{for:"defaultDuration",class:"form-label mb-0"},"Default duration minutes:",-1),on={class:"row g-1"},rn={class:"col-2"},an={class:"col-10 pt-1"},ln={class:"mb-4"},dn=e("label",{for:"hourThreshold",class:"form-label mb-0"},"Single digit hour threshold:",-1),cn={class:"row g-1"},un={class:"col-2"},hn={class:"col-10 pt-1"},pn={class:"mb-4"},mn={for:"defaultRate",class:"form-label mb-0"},gn={class:"row g-1"},fn={class:"col-2"},_n={class:"col-10 pt-1"},bn={class:"form-check form-switch mb-4"},yn=e("label",{class:"form-check-label",for:"rateIncludesTax"}," rate includes tax ",-1),wn={class:"mb-4"},vn=e("label",{for:"tax",class:"form-label mb-0"},"Tax rate (%):",-1),kn={class:"row g-1"},xn={class:"col-2"},Sn={class:"col-10 pt-1"},Dn={class:"input-group input-group-sm mb-4"},Cn=e("div",{class:"input-group-text"},[e("label",{for:"dateFormat"},"Date Format"),e("a",{tabindex:"0",role:"button",class:"badge border rounded-circle small ms-2","data-bs-toggle":"popover","data-bs-content":"the date format must include yy, mm and dddd, in any order, separated by any character"},"?")],-1),Tn={class:"input-group input-group-sm mb-4"},In=e("div",{class:"input-group-text"},[e("label",{for:"currencyFormat"},"Currency Format"),e("a",{class:"badge border rounded-circle small ms-2",tabindex:"0",role:"button","data-bs-toggle":"popover","data-bs-content":"%s will be replaced with actual amount"},"?")],-1),$n={class:"input-group input-group-sm mb-4 position-relative"},Ln=e("label",{for:"defaultProject",class:"input-group-text"},"Default %project",-1),Fn={class:"input-group input-group-sm mb-4"},Rn=e("label",{for:"defaultClient",class:"input-group-text"},"Default @client",-1),Mn={class:"input-group input-group-sm mb-4"},En=e("label",{for:"defaultTask",class:"input-group-text"},"Default #task",-1),Un={class:"input-group input-group-sm mb-4"},Pn=e("label",{for:"defaultSource",class:"input-group-text"},"Default /source",-1),jn={class:"form-check form-switch mb-4"},On=e("label",{class:"form-check-label",for:"showCostColumn"},[u(" show "),e("code",null,"cost"),u(" column ")],-1),Vn={class:"form-check form-switch mb-4"},An=e("label",{class:"form-check-label",for:"showProjectColumn"},[u(" show "),e("code",null,"project"),u(" column ")],-1),Bn={class:"form-check form-switch mb-4"},Hn=e("label",{class:"form-check-label",for:"showClientColumn"},[u(" show "),e("code",null,"client"),u(" column ")],-1),zn={class:"form-check form-switch mb-4"},Nn=e("label",{class:"form-check-label",for:"showTaskColumn"},[u(" show "),e("code",null,"task"),u(" column ")],-1),qn={class:"form-check form-switch mb-4"},Yn=e("label",{class:"form-check-label",for:"showSourceColumn"},[u(" show "),e("code",null,"source"),u(" column ")],-1),Kn={class:"form-check form-switch mb-4"},Qn=e("label",{class:"form-check-label",for:"showIndexColumn"},[u(" show "),e("code",null,"index"),u(" column, if you want to use "),e("code",null,"!n"),u(" syntax ")],-1),Jn={class:"form-check form-switch mb-4"},Wn=e("label",{class:"form-check-label",for:"showDupeButton"}," show duplicate button ",-1),Gn={class:"form-check form-switch mb-4"},Zn=e("label",{class:"form-check-label",for:"keepOriginalLogOnEdit"}," keep original log when date is changed while editing ",-1),Xn={class:"input-group input-group-sm mb-4"},to=e("div",{class:"input-group-text"},[e("label",{for:"dateRangeFormat"},[e("span",{class:"d-none d-lg-inline"},"Date Range Format"),e("span",{class:"d-lg-none"},"Dt Rng Frmt")]),e("a",{tabindex:"0",role:"button",class:"badge border rounded-circle small ms-2","data-bs-toggle":"popover","data-bs-content":"Same as date format. Start date placeholders with trailing '?' will be omitted when date component is same on end date"},"?")],-1),eo={class:"form-check form-switch mb-4"},so=e("label",{class:"form-check-label",for:"closeFiltersOnApply"}," Close Filters on Apply/Clear ",-1),no={class:"input-group input-group-sm mb-4"},oo=e("div",{class:"input-group-text"},[e("label",{for:"filenameTemplate"},"DL Filename"),e("a",{tabindex:"0",role:"button",class:"badge border rounded-circle small ms-2","data-bs-toggle":"popover","data-bs-content":"%s will be replaced with date range"},"?")],-1),io={class:"input-group input-group-sm mb-4"},ro=e("label",{for:"deviceName",class:"input-group-text"},"Device name",-1),ao={class:"input-group input-group-sm mb-4"},lo=e("label",{for:"deviceId",class:"input-group-text"},"Device ID",-1),co={class:"d-flex justify-content-center"};function uo(r,t,n,a,s,o){return l(),d("div",os,[e("div",is,[e("div",rs,[as,e("div",ls,[e("ul",ds,[e("li",cs,[e("a",{class:I(["nav-link px-2 px-lg-3",{active:s.currentTab==="input"}]),href:"#",onClick:t[0]||(t[0]=y(i=>s.currentTab="input",["stop","prevent"]))},"Input",2)]),e("li",us,[e("a",{class:I(["nav-link px-2 px-lg-3",{active:s.currentTab==="sync"}]),href:"#",onClick:t[1]||(t[1]=y(i=>s.currentTab="sync",["stop","prevent"]))},ms,2)]),e("li",gs,[e("a",{class:I(["nav-link px-2 px-lg-3",{active:s.currentTab==="timelogs"}]),href:"#",onClick:t[2]||(t[2]=y(i=>s.currentTab="timelogs",["stop","prevent"]))},bs,2)]),e("li",ys,[e("a",{class:I(["nav-link px-2 px-lg-3",{active:s.currentTab==="table"}]),href:"#",onClick:t[3]||(t[3]=y(i=>s.currentTab="table",["stop","prevent"]))},"Table",2)]),e("li",ws,[e("a",{class:I(["nav-link px-2 px-lg-3",{active:s.currentTab==="misc"}]),href:"#",onClick:t[4]||(t[4]=y(i=>s.currentTab="misc",["stop","prevent"]))},"Misc",2)])]),m(e("div",null,[e("div",vs,[m(e("input",{class:"form-check-input setting",type:"checkbox",value:"",id:"storeOnControlEnter","onUpdate:modelValue":t[5]||(t[5]=i=>o.settings.storeOnControlEnter=i)},null,512),[[T,o.settings.storeOnControlEnter]]),ks]),e("div",xs,[m(e("input",{class:"form-check-input setting",type:"checkbox",value:"",id:"clearTimeLogOnStore","onUpdate:modelValue":t[6]||(t[6]=i=>o.settings.clearTimeLogOnStore=i)},null,512),[[T,o.settings.clearTimeLogOnStore]]),Ss]),e("div",Ds,[m(e("input",{class:"form-check-input setting",type:"checkbox",value:"",id:"showParsePreviewOnType","onUpdate:modelValue":t[7]||(t[7]=i=>o.settings.showParsePreviewOnType=i)},null,512),[[T,o.settings.showParsePreviewOnType]]),Cs]),e("div",Ts,[m(e("input",{class:"form-check-input setting",type:"checkbox",value:"",id:"showHelpIcon","onUpdate:modelValue":t[8]||(t[8]=i=>o.settings.showHelpIcon=i)},null,512),[[T,o.settings.showHelpIcon]]),Is]),e("div",$s,[m(e("input",{class:"form-check-input setting",type:"checkbox",value:"",id:"defaultDateInsideSelection","onUpdate:modelValue":t[9]||(t[9]=i=>o.settings.defaultDateInsideSelection=i)},null,512),[[T,o.settings.defaultDateInsideSelection]]),Ls,Fs])],512),[[R,s.currentTab==="input"]]),m(e("div",null,[n.sync.hasCredentials?f("",!0):(l(),d("p",Rs," Set up sync credentials first to enable sync features ")),e("div",{class:I({"opacity-25":!n.sync.hasCredentials})},[e("div",Ms,[m(e("input",{disabled:!n.sync.hasCredentials,class:"form-check-input setting",type:"checkbox",value:"",id:"syncEnabled","onUpdate:modelValue":t[10]||(t[10]=i=>o.settings.syncEnabled=i)},null,8,Es),[[T,o.settings.syncEnabled]]),Us]),e("div",Ps,[m(e("input",{disabled:!n.sync.hasCredentials,class:"form-check-input setting",type:"checkbox",value:"",id:"syncSettings","onUpdate:modelValue":t[11]||(t[11]=i=>o.settings.syncSettings=i)},null,8,js),[[T,o.settings.syncSettings]]),Os]),e("div",Vs,[m(e("input",{disabled:!n.sync.hasCredentials,class:"form-check-input setting",type:"checkbox",value:"",id:"syncSettings","onUpdate:modelValue":t[12]||(t[12]=i=>o.settings.syncOnLoad=i)},null,8,As),[[T,o.settings.syncOnLoad]]),Bs]),e("div",Hs,[zs,e("div",Ns,[e("div",qs,[m(e("input",{disabled:!n.sync.hasCredentials,id:"syncAfterSeconds",class:"form-control form-control-sm",min:"0",max:"240",type:"number","onUpdate:modelValue":t[13]||(t[13]=i=>o.settings.syncAfterSeconds=i)},null,8,Ys),[[w,o.settings.syncAfterSeconds,void 0,{number:!0}]])]),e("div",Ks,[m(e("input",{disabled:!n.sync.hasCredentials,type:"range",class:"form-range",min:"0",max:"600","onUpdate:modelValue":t[14]||(t[14]=i=>o.settings.syncAfterSeconds=i)},null,8,Qs),[[w,o.settings.syncAfterSeconds,void 0,{number:!0}]])])])]),e("div",Js,[Ws,e("div",Gs,[e("div",Zs,[m(e("input",{disabled:!n.sync.hasCredentials,id:"checkForUpdateIntervalMinutes",class:"form-control form-control-sm",min:"0",max:"240",type:"number","onUpdate:modelValue":t[15]||(t[15]=i=>o.settings.checkForUpdateIntervalMinutes=i)},null,8,Xs),[[w,o.settings.checkForUpdateIntervalMinutes,void 0,{number:!0}]])]),e("div",tn,[m(e("input",{disabled:!n.sync.hasCredentials,type:"range",class:"form-range",min:"0",max:"240","onUpdate:modelValue":t[16]||(t[16]=i=>o.settings.checkForUpdateIntervalMinutes=i)},null,8,en),[[w,o.settings.checkForUpdateIntervalMinutes,void 0,{number:!0}]])])])])],2)],512),[[R,s.currentTab==="sync"]]),m(e("div",null,[e("div",sn,[nn,e("div",on,[e("div",rn,[m(e("input",{id:"defaultDuration",class:"form-control form-control-sm",min:"5",max:"240",type:"number","onUpdate:modelValue":t[17]||(t[17]=i=>o.settings.defaultDuration=i)},null,512),[[w,o.settings.defaultDuration,void 0,{number:!0}]])]),e("div",an,[m(e("input",{type:"range",class:"form-range",min:"5",max:"240","onUpdate:modelValue":t[18]||(t[18]=i=>o.settings.defaultDuration=i)},null,512),[[w,o.settings.defaultDuration,void 0,{number:!0}]])])])]),e("div",ln,[dn,e("div",cn,[e("div",un,[m(e("input",{id:"hourThreshold",class:"form-control form-control-sm",min:"1",max:"24",type:"number","onUpdate:modelValue":t[19]||(t[19]=i=>o.settings.hourThreshold=i)},null,512),[[w,o.settings.hourThreshold,void 0,{number:!0}]])]),e("div",hn,[m(e("input",{type:"range",class:"form-range",min:"1",max:"24","onUpdate:modelValue":t[20]||(t[20]=i=>o.settings.hourThreshold=i)},null,512),[[w,o.settings.hourThreshold,void 0,{number:!0}]])])])]),e("div",pn,[e("label",mn,"Default rate ("+p(o.util.formatAmount(o.settings.defaultRate,o.settings.currencyFormat))+"):",1),e("div",gn,[e("div",fn,[m(e("input",{id:"defaultRate",class:"form-control form-control-sm",min:"0",max:"1000",type:"number","onUpdate:modelValue":t[21]||(t[21]=i=>o.settings.defaultRate=i)},null,512),[[w,o.settings.defaultRate,void 0,{number:!0}]])]),e("div",_n,[m(e("input",{type:"range",class:"form-range",min:"0",max:"1000","onUpdate:modelValue":t[22]||(t[22]=i=>o.settings.defaultRate=i)},null,512),[[w,o.settings.defaultRate,void 0,{number:!0}]])])])]),e("div",bn,[m(e("input",{class:"form-check-input setting",type:"checkbox",value:"",id:"rateIncludesTax","onUpdate:modelValue":t[23]||(t[23]=i=>o.settings.rateIncludesTax=i)},null,512),[[T,o.settings.rateIncludesTax]]),yn]),e("div",wn,[vn,e("div",kn,[e("div",xn,[m(e("input",{id:"tax",class:"form-control form-control-sm",min:"0",max:"100",step:"0.1",type:"number","onUpdate:modelValue":t[24]||(t[24]=i=>o.settings.tax=i)},null,512),[[w,o.settings.tax,void 0,{number:!0}]])]),e("div",Sn,[m(e("input",{type:"range",class:"form-range",min:"0",max:"100",step:"0.1","onUpdate:modelValue":t[25]||(t[25]=i=>o.settings.tax=i)},null,512),[[w,o.settings.tax,void 0,{number:!0}]])])])]),e("div",Dn,[Cn,m(e("input",{type:"text",class:I(["form-control",{"is-invalid":!s.dateFormatIsValid}]),id:"dateFormat","onUpdate:modelValue":t[26]||(t[26]=i=>o.settings.dateFormat=i)},null,2),[[w,o.settings.dateFormat]])]),e("div",Tn,[In,m(e("input",{type:"text",class:I(["form-control",{"is-invalid":!s.currencyIsValid}]),id:"currencyFormat","onUpdate:modelValue":t[27]||(t[27]=i=>o.settings.currencyFormat=i)},null,2),[[w,o.settings.currencyFormat]])]),e("div",$n,[Ln,m(e("input",{type:"text",class:"form-control",id:"defaultProject","onUpdate:modelValue":t[28]||(t[28]=i=>o.settings.defaultProject=i)},null,512),[[w,o.settings.defaultProject]]),o.settings.defaultProject?(l(),d("span",{key:0,class:"position-absolute end-0 top-50 translate-middle btn btn-sm btn-close pe-0",onClick:t[29]||(t[29]=i=>o.settings.defaultProject="")})):f("",!0)]),e("div",Fn,[Rn,m(e("input",{type:"text",class:"form-control",id:"defaultClient","onUpdate:modelValue":t[30]||(t[30]=i=>o.settings.defaultClient=i)},null,512),[[w,o.settings.defaultClient]]),o.settings.defaultClient?(l(),d("span",{key:0,class:"position-absolute end-0 top-50 translate-middle btn btn-sm btn-close pe-0",onClick:t[31]||(t[31]=i=>o.settings.defaultClient="")})):f("",!0)]),e("div",Mn,[En,m(e("input",{type:"text",class:"form-control",id:"defaultTask","onUpdate:modelValue":t[32]||(t[32]=i=>o.settings.defaultTask=i)},null,512),[[w,o.settings.defaultTask]]),o.settings.defaultTask?(l(),d("span",{key:0,class:"position-absolute end-0 top-50 translate-middle btn btn-sm btn-close pe-0",onClick:t[33]||(t[33]=i=>o.settings.defaultTask="")})):f("",!0)]),e("div",Un,[Pn,m(e("input",{type:"text",class:"form-control",id:"defaultSource","onUpdate:modelValue":t[34]||(t[34]=i=>o.settings.defaultSource=i)},null,512),[[w,o.settings.defaultSource]]),o.settings.defaultSource?(l(),d("span",{key:0,class:"position-absolute end-0 top-50 translate-middle btn btn-sm btn-close pe-0",onClick:t[35]||(t[35]=i=>o.settings.defaultSource="")})):f("",!0)])],512),[[R,s.currentTab==="timelogs"]]),m(e("div",null,[e("div",jn,[m(e("input",{class:"form-check-input setting",type:"checkbox",value:"",id:"showCostColumn","onUpdate:modelValue":t[36]||(t[36]=i=>o.settings.showCostColumn=i)},null,512),[[T,o.settings.showCostColumn]]),On]),e("div",Vn,[m(e("input",{class:"form-check-input setting",type:"checkbox",value:"",id:"showProjectColumn","onUpdate:modelValue":t[37]||(t[37]=i=>o.settings.showProjectColumn=i)},null,512),[[T,o.settings.showProjectColumn]]),An]),e("div",Bn,[m(e("input",{class:"form-check-input setting",type:"checkbox",value:"",id:"showClientColumn","onUpdate:modelValue":t[38]||(t[38]=i=>o.settings.showClientColumn=i)},null,512),[[T,o.settings.showClientColumn]]),Hn]),e("div",zn,[m(e("input",{class:"form-check-input setting",type:"checkbox",value:"",id:"showTaskColumn","onUpdate:modelValue":t[39]||(t[39]=i=>o.settings.showTaskColumn=i)},null,512),[[T,o.settings.showTaskColumn]]),Nn]),e("div",qn,[m(e("input",{class:"form-check-input setting",type:"checkbox",value:"",id:"showSourceColumn","onUpdate:modelValue":t[40]||(t[40]=i=>o.settings.showSourceColumn=i)},null,512),[[T,o.settings.showSourceColumn]]),Yn]),e("div",Kn,[m(e("input",{class:"form-check-input setting",type:"checkbox",value:"",id:"showIndexColumn","onUpdate:modelValue":t[41]||(t[41]=i=>o.settings.showIndexColumn=i)},null,512),[[T,o.settings.showIndexColumn]]),Qn]),e("div",Jn,[m(e("input",{class:"form-check-input setting",type:"checkbox",value:"",id:"showDupeButton","onUpdate:modelValue":t[42]||(t[42]=i=>o.settings.showDupeButton=i)},null,512),[[T,o.settings.showDupeButton]]),Wn])],512),[[R,s.currentTab==="table"]]),m(e("div",null,[e("div",Gn,[m(e("input",{class:"form-check-input setting",type:"checkbox",value:"",id:"keepOriginalLogOnEdit","onUpdate:modelValue":t[43]||(t[43]=i=>o.settings.keepOriginalLogOnEdit=i)},null,512),[[T,o.settings.keepOriginalLogOnEdit]]),Zn]),e("div",Xn,[to,m(e("input",{type:"text",class:I(["form-control",{"is-invalid":!s.dateRangeFormatIsValid}]),id:"dateRangeFormat","onUpdate:modelValue":t[44]||(t[44]=i=>o.settings.dateRangeFormat=i)},null,2),[[w,o.settings.dateRangeFormat]])]),e("div",eo,[m(e("input",{class:"form-check-input setting",type:"checkbox",value:"",id:"closeFiltersOnApply","onUpdate:modelValue":t[45]||(t[45]=i=>o.settings.closeFiltersOnApply=i)},null,512),[[T,o.settings.closeFiltersOnApply]]),so]),e("div",no,[oo,m(e("input",{type:"text",class:"form-control",id:"filenameTemplate","onUpdate:modelValue":t[46]||(t[46]=i=>o.settings.filenameTemplate=i)},null,512),[[w,o.settings.filenameTemplate]])]),e("div",io,[ro,m(e("input",{type:"text",class:"form-control",id:"deviceName","onUpdate:modelValue":t[47]||(t[47]=i=>o.settings.deviceName=i)},null,512),[[w,o.settings.deviceName]])]),e("div",ao,[lo,m(e("input",{type:"text",class:"form-control",id:"deviceId","onUpdate:modelValue":t[48]||(t[48]=i=>o.settings.deviceId=i),readonly:""},null,512),[[w,o.settings.deviceId]])])],512),[[R,s.currentTab==="misc"]]),e("div",co,[e("button",{class:"btn btn-primary",onClick:t[49]||(t[49]=(...i)=>o.saveSettings&&o.saveSettings(...i))}," Save settings ")])])])])],512)}var ho=k(ns,[["render",uo]]);class q{constructor(t,n){x(this,"data",[]);x(this,"index",{});x(this,"transactions",[]);x(this,"timelogParser");x(this,"transactionItemLimit",16);x(this,"options");x(this,"currentTransaction",null);x(this,"currentSelection");this.options=n,this.timelogParser=t;let a=this.options.storage.get("data",[]);a.length>0&&a[0]!==null&&"day"in a[0]&&(console.log("purging old version data..."),this.options.storage.set("data",[]),a=[]),a&&(this.data=a);let s=this.options.storage.get("transactions");s&&(this.transactions=s),this.transactions.length>0&&!this.transactions[this.transactions.length-1].committedAt&&(this.currentTransaction=this.transactions[this.transactions.length-1]),this.makeIndex()}checkIntegrity(){if(this.data.length>0&&this.transactions.length===0&&!this.currentTransaction&&this.data.length>0)this.data.forEach(t=>this.addToTransaction(t)),this.commit(!0);else if(this.transactions.length>0&&this.data.length===0){this.commit(!1);let t=this.transactions.slice();this.transactions=[],this.mergeTransactions(t)}}makeIndex(){const t={};for(let n=this.data.length-1;n>=0;n--)t[this.data[n].timestamp]=Math.max(t[this.data[n].timestamp]||-1/0,n);this.index=t}findIndexByDate(t){let n=t in this.index?this.index[t]:this.data.length-1;if(t in this.index)return this.index[t]+1;if(this.data.length>0&&t>this.data[this.data.length-1].timestamp)return this.data.length;if(this.data.length>0&&t<this.data[0].timestamp)return 0;for(let a=n;a>=0;a--)if(this.data[a]&&t>=this.data[a].timestamp)return a===this.data.length-1?a-1:a+1;return 0}findTimelogIndex(t){if(this.data.length===1)return 0;let n=this.findIndexByDate(t.timestamp);if(this.data[n]&&this.data[n].hash===t.hash)return n;for(let a=n;a>=0;a--)if(this.data[a]&&this.data[a].hash===t.hash)return a;return!1}addToTransaction(t,n="insert"){if(this.currentTransaction||this.createTransaction(),this.currentTransaction.operations.hasOwnProperty(n)||(this.currentTransaction.operations[n]=[]),n==="update"){let s=!1,o=["insert","update"];t:for(let i of o)if(i in this.currentTransaction.operations){for(let c=0;c<this.currentTransaction.operations[i].length;c++)if(this.currentTransaction.operations[i][c].indexOf(t.hash)===1){this.currentTransaction.operations[i].splice(c,1,t.normalized),s=!0;break t}}s||this.currentTransaction.operations.update.push(t.normalized)}else if(n==="delete"){let s={insert:!1,update:!1},o=["insert","update"];for(let i of o)if(i in this.currentTransaction.operations){for(let c=0;c<this.currentTransaction.operations[i].length;c++)if(this.currentTransaction.operations[i][c].indexOf(t.hash)===1){this.currentTransaction.operations[i].splice(c,1),s[i]=!0;break}}s.insert||this.currentTransaction.operations.delete.push(t.normalized)}else n==="insert"&&this.currentTransaction.operations.insert.push(t.normalized);let a=0;for(const s in this.currentTransaction.operations)a+=this.currentTransaction.operations[s].length;return a>=this.transactionItemLimit&&(this.commit(),this.options.storeFunction()),!0}insert(t,n=!1){const a=this.findIndexByDate(t.timestamp);return this.data.splice(a,0,t),n||this.addToTransaction(t),this.store(),!0}store(){this.makeIndex(),this.storeTransactions(),this.options.storage.set("data",this.data)}delete(t,n=!1){const a=this.findTimelogIndex(t);return typeof a=="number"&&(this.data.splice(a,1),n||this.addToTransaction(t,"delete")),this.store(),!0}update(t,n=!1){const a=this.findTimelogIndex(t);return typeof a=="number"&&(this.data[a]=t,n||this.addToTransaction(t,"update")),this.store(),!0}storeTransactions(){this.transactions.sort((t,n)=>(t.committedAt||1e13)-(n.committedAt||1e13)),this.options.storage.set("transactions",this.transactions)}commit(t=!1){if(this.currentTransaction){for(const n in this.currentTransaction.operations)this.currentTransaction.operations[n].length===0&&delete this.currentTransaction.operations[n];this.currentTransaction.committedAt=Date.now()+this.transactions.length,t&&this.storeTransactions(),this.currentTransaction=!1;return}t&&this.storeTransactions()}createTransaction(){let t=Date.now();this.currentTransaction={hash:this.options.util.hash(16),createdAt:t,committedAt:!1,operations:{},origin:this.options.deviceId},this.transactions.push(this.currentTransaction)}mergeTransaction(t){this.currentTransaction&&this.commit(!0);for(let n=0;n<this.transactions.length;n++)if(this.transactions[n].hash===t.hash)return!1;return this.transactions.unshift(t),Object.keys(t.operations).forEach(n=>{t.operations[n].forEach(a=>{typeof a=="string"&&(a=this.timelogParser.parse(a)),this[n](a,!0)})}),this.storeTransactions(),!0}mergeTransactions(t){let n=0;for(let a=0;a<t.length;a++)n+=this.mergeTransaction(t[a])?1:0;return n}get(t,n,a){let s=null,o=null;t.setHours(0),n.setHours(23),n.setMinutes(59);const i={lower:t,upper:n},c={},h={clients:[],projects:[],sources:[],tasks:[]};if(this.data.length>0&&this.data[this.data.length-1].timestamp>=i.lower&&this.data[0].timestamp<=i.upper){for(let S=this.data.length-1;S>=0&&(this.data[S].timestamp<=i.upper&&!s&&(s=S),!(this.data[S].timestamp<i.lower));S--)o=S;const b=this.data.slice(o,s+1).reverse(),L=!a||!Object.values(a).some(S=>S.length>0);b.filter(S=>L||this.filter(a,S)).forEach(S=>{const M=S.timestamp;M in c||(c[M]={date:new Date(M),total:0,cost:0,logs:[]}),c[M].total+=S.duration,c[M].cost+=S.cost,c[M].logs.push(S),Object.keys(h).forEach(V=>h[V].push(...S[V]))})}Object.keys(h).forEach(b=>h[b]=[...new Set(h[b])]);const _=Object.values(c);let g=[],C=[],U=0;return _.forEach((b,L)=>{C.push([]),b.logs.forEach((S,M)=>{g[U]=[L,M],C[L].push(U),U++})}),this.currentSelection={matchedProperties:h,days:_,range:i,indexToLogMap:g,logIndexToIndexMap:C},this.currentSelection}slice(t=0,n=10,a){const s=new Date,o={date:s,logs:this.data.slice().reverse().slice(t,n),total:0,cost:0};return{indexToLogMap:[[]],logIndexToIndexMap:[[]],days:{[0]:o},matchedProperties:{clients:[],projects:[],sources:[],tasks:[]},range:{}}}filter(t,n){for(const a in t)if(t[a].length>0&&!n[a].some(s=>t[a].includes(s)))return!1;return!0}}const po={inject:["settings","util"],name:"InspectDialog",props:{timelogStore:q},data(){return{view:"transactions",transactionIndex:0,modal:null}},mounted(){this.modal=new B(this.$refs.modal),this.$refs.modal.addEventListener("shown.bs.modal",r=>this.view="transactions"),this.$refs.modal.addEventListener("hidden.bs.modal",r=>this.view=null)},methods:{showTransaction(r){this.view="detail",this.transactionIndex=this.timelogStore.transactions.length-r-1},show(){this.modal.show()}}},mo={class:"modal fade",ref:"modal",id:"inspectDataModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"inspectDataModalLabel","aria-hidden":"true"},go={class:"modal-dialog modal-lg modal-dialog-scrollable modal-fullscreen-md-down"},fo={class:"modal-content"},_o=e("div",{class:"modal-header"},[e("h5",{class:"modal-title fw-light",id:"inspectDataModalLabel"},"Inspect local data"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),bo={class:"modal-body"},yo={key:0},wo={class:"table-sm table"},vo=e("td",null,"Hash",-1),ko=e("td",null,"device",-1),xo=e("td",null,"created",-1),So=e("td",null,"committed",-1),Do={key:0},Co={key:0},To={class:"list-group list-group-flush"},Io={class:"list-group-item"},$o={key:1,class:"table-responsive"},Lo=e("h5",null,"Transactions",-1),Fo={class:"table table-sm table-hover"},Ro=e("thead",null,[e("tr",null,[e("th",null," hash "),e("th",null," origin "),e("th",null," created "),e("th",null," committed "),e("th",null," inserts "),e("th",null," updates "),e("th",null," deletes ")])],-1),Mo=["onClick"],Eo={key:0};function Uo(r,t,n,a,s,o){return l(),d("div",mo,[e("div",go,[e("div",fo,[_o,e("div",bo,[s.view==="detail"?(l(),d("div",yo,[e("button",{class:"btn btn-link",onClick:t[0]||(t[0]=i=>s.view="transactions")},"back "),e("table",wo,[e("tbody",null,[e("tr",null,[vo,e("td",null,p(n.timelogStore.transactions[s.transactionIndex].hash),1)]),e("tr",null,[ko,e("td",null,p(n.timelogStore.transactions[s.transactionIndex].origin===o.settings.deviceId?"this device":String(n.timelogStore.transactions[s.transactionIndex].origin).slice(0,4)+"..."),1)]),e("tr",null,[xo,e("td",null,p(o.util.formatDate(n.timelogStore.transactions[s.transactionIndex].createdAt,o.settings.dateFormat)),1)]),e("tr",null,[So,e("td",null,[n.timelogStore.transactions[s.transactionIndex].committedAt?(l(),d("span",Do,p(o.util.formatDate(n.timelogStore.transactions[s.transactionIndex].committedAt,o.settings.dateFormat)),1)):(l(),d("a",{key:1,href:"#",onClick:t[1]||(t[1]=y(i=>n.timelogStore.commit(!0),["stop","prevent"]))},"commit"))])])])]),(l(),d($,null,F(["insert","delete","update"],(i,c)=>(l(),d($,null,[i in n.timelogStore.transactions[s.transactionIndex].operations?(l(),d("div",Co,[e("h5",null,p(i),1),e("ul",To,[(l(!0),d($,null,F(n.timelogStore.transactions[s.transactionIndex].operations[i],(h,_)=>(l(),d("li",Io,[e("pre",null,[e("code",null,p(h),1)])]))),256))])])):f("",!0)],64))),64))])):f("",!0),s.view==="transactions"?(l(),d("div",$o,[Lo,e("table",Fo,[Ro,e("tbody",null,[(l(!0),d($,null,F(n.timelogStore.transactions.slice().reverse(),(i,c)=>(l(),d("tr",{onClick:h=>o.showTransaction(c),class:"cursor-pointer"},[e("td",null,p(i.hash.slice(0,4)+"..."),1),e("td",null,p(i.origin===o.settings.deviceId?"this device":String(i.origin).slice(0,4)+"..."),1),e("td",null,p(o.util.formatDate(i.createdAt,o.settings.dateFormat)),1),e("td",null,[i.committedAt?(l(),d("span",Eo,p(o.util.formatDate(i.committedAt,o.settings.dateFormat)),1)):(l(),d("a",{key:1,href:"#",onClick:t[2]||(t[2]=y(h=>n.timelogStore.commit(!0),["stop","prevent"]))},"commit"))]),e("td",null,p(i.operations.insert?i.operations.insert.length:0),1),e("td",null,p(i.operations.update?i.operations.update.length:0),1),e("td",null,p(i.operations.delete?i.operations.delete.length:0),1)],8,Mo))),256))])])])):f("",!0)])])])],512)}var Po=k(po,[["render",Uo]]);const jo={inject:["globalStore"],name:"ToastBox"},Oo={class:"toast-container position-fixed bottom-0 start-50 translate-middle-x",style:{"z-index":"8192"}},Vo={class:"toast show",role:"alert","aria-live":"assertive","aria-atomic":"true"},Ao={class:"toast-header"},Bo={class:"me-auto"},Ho={key:0,class:"toast-body"};function zo(r,t,n,a,s,o){return l(),d("div",Oo,[(l(!0),d($,null,F(o.globalStore.toasts,i=>(l(),d("div",Vo,[e("div",Ao,[e("strong",Bo,p(i.title),1)]),i.body?(l(),d("div",Ho,p(i.body),1)):f("",!0)]))),256))])}var No=k(jo,[["render",zo]]);const qo={props:{sync:z}},Yo={class:"offcanvas offcanvas-end",tabindex:"-1",id:"offcanvasControls","aria-labelledby":"offcanvasControlsLabel"},Ko=e("div",{class:"offcanvas-header pb-2 pb-lg-3"},[e("h5",{class:"offcanvas-title",id:"offcanvasControlsLabel"}),e("button",{type:"button",class:"btn-close text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1),Qo={class:"offcanvas-body pt-0 pt-lg-3"},Jo={class:"list-group list-group-flush mb-2 pb-2 border-bottom"},Wo={class:"list-group list-group-flush mb-2 pb-2 border-bottom"},Go={class:"list-group list-group-flush"};function Zo(r,t,n,a,s,o){return l(),d("div",Yo,[Ko,e("div",Qo,[e("div",Jo,[e("a",{href:"#",class:"list-group-item list-group-item-action",onClick:t[0]||(t[0]=y(i=>r.$emit("show-settings"),["stop","prevent"]))},"Settings")]),e("div",Wo,[e("a",{href:"#",class:"list-group-item list-group-item-action",onClick:t[1]||(t[1]=y(i=>r.$emit("show-sync-options"),["stop","prevent"]))},"Sync options"),e("a",{href:"#",class:I(["list-group-item list-group-item-action",{disabled:!n.sync.hasCredentials}]),onClick:t[2]||(t[2]=y(i=>r.$emit("sync-now"),["stop","prevent"]))},"Sync Now",2),e("a",{href:"#",class:"list-group-item list-group-item-action",onClick:t[3]||(t[3]=y(i=>r.$emit("inspect-data"),["stop","prevent"]))},"Inspect Sync Data")]),e("div",Go,[e("a",{href:"#",class:"list-group-item list-group-item-action",onClick:t[4]||(t[4]=y(i=>r.$emit("show-import-dialog"),["stop","prevent"]))},"Import / Export"),e("a",{href:"#",class:"list-group-item list-group-item-action",onClick:t[5]||(t[5]=y(i=>r.$emit("show-help-dialog"),["stop","prevent"]))},"Help & Howto")])])])}var Xo=k(qo,[["render",Zo]]);class rt{constructor(){x(this,"dateRegExpCache",{});x(this,"internalFormat","yyyy-mm-dd")}lzp(t){return("0"+t).slice(-2)}formatRange(t,n,a){t=t instanceof Date?t:new Date(t),n=n instanceof Date?n:new Date(n);const s=this.lzp(t.getDate()),o=this.lzp(t.getMonth()+1),i=String(t.getFullYear()),c=this.lzp(n.getDate()),h=this.lzp(n.getMonth()+1),_=String(n.getFullYear()),g=i!==_,C=o!==h,U=a.indexOf("mm?")>-1,b=a.indexOf("yyyy?")>-1;let L=a.replace("dd",s);return L=L.replace(/mm\??/,U?C?o:"":o).replace(/yyyy\??/,b?g?i:"":i),L=L.replace("dd",c).replace("mm",h).replace("yyyy",_),L.replace(/^[^\d]+/,"").replace(/([^\d])\1+/g,"$1")}convertFormattedString(t,n,a){return this.formatDate(this.dateFromFormattedString(t,n),a)}findFormattedDateInString(t,n){const a=t.match(this.formatRegExps(n).formatMatchRegExp);if(a&&a.length>=2)return a[0]}convertFormattedDateInString(t,n,a){const s=this.findFormattedDateInString(t,n);return s?t.replace(s,this.formatDate(this.dateFromFormattedString(s,n),a)):t}formatDate(t,n="yyyy-mm-dd"){t=t instanceof Date?t:new Date(t);let a={dd:this.lzp(t.getDate()),d:String(t.getDate()),mm:this.lzp(t.getMonth()+1),m:String(t.getMonth()+1),yyyy:String(t.getFullYear()),yy:String(parseInt(String(t.getFullYear()).slice(-2)))};for(const s in a){const o=new RegExp(`\\b${s}\\b`);n=n.replace(o,a[s])}return n}escapeRegExp(t){return t.replace(/[.*+?^${}()|\/[\]\\]/g,"\\$&")}findDateInString(t){return t.match(this.formatRegExps().dateMatchRegExp)}formatRegExps(t){if(t||(t=this.internalFormat),t in this.dateRegExpCache)return this.dateRegExpCache[t];let n=this.escapeRegExp([...new Set(t.replace(/\w/g,"").split(""))].join("")),a=new RegExp(`(?<![+:\\d]|[\\/@%#]\\w+)(:([-|+]?[\\w\\d${n}]{1,10}))`),s=new RegExp("^"+this.escapeRegExp(t).replace(/dd?/,"(\\d\\d?)").replace(/mm?/,"(\\d\\d?)").replace(new RegExp(`(${n})(y{2,4})`),"$1?$2").replace(new RegExp(`(y{2,4})(${n})`),"$1$2?").replace(/y{2,4}/,"(\\d{4})?")+"$"),o=new RegExp("("+this.escapeRegExp(t).replace(/dd?/,"\\d\\d?").replace(/mm?/,"\\d\\d?").replace(new RegExp(`(${n})(y{2,4})`),"$1?$2").replace(new RegExp(`(y{2,4})(${n})`),"$1$2?").replace(/y{2,4}/,"(\\d{4})?")+")"),i=[["d",t.indexOf("d")],["m",t.indexOf("m")],["y",t.indexOf("y")]];return i.sort((c,h)=>c[1]-h[1]),i=i.map((c,h)=>[c[0],h]),this.dateRegExpCache[t]={formatMatchRegExp:o,dateMatchRegExp:a,actualDateMatchRegExp:s,indexes:i.reduce((c,h)=>(c[h[0]]=h[1],c),{})},this.dateRegExpCache[t]}dateFromFormattedString(t,n){let a=this.formatRegExps(n||this.internalFormat),s=t.match(a.actualDateMatchRegExp);if(s){let o=Number(s[a.indexes.y+1]||new Date().getFullYear()),i=Number(s[a.indexes.m+1])-1,c=Number(s[a.indexes.d+1]);return new Date(o,i,c)}return new Date}parseDuration(t,n,a){if(t.slice(0,1)==="+"&&(t=t.slice(1)),/^\d\d?\d?$/.test(t)){const s=parseInt(t);return s<=a?s*60:s}if(/\d{0,2}:\d{1,2}/.test(t)){let[s,o]=t.split(":");return s=s?parseInt(s):0,o=o?parseInt(o):0,s*60+o}if(/\d{0,2}\.\d{1,2}/.test(t)){let[s,o]=t.split("."),i=o.slice(0,1)==="0";return s=s?parseInt(s):0,o=o?parseInt(o):0,o<10&&!i&&(o=o*10),o=o/100,s*60+Math.round(60*o)}return n}parseDate(t,n,a=new Date){t=String(t),t.slice(0,1)===":"&&(t=t.slice(1));const s=864e5,o=["sun","mon","tue","wed","thu","fri","sat"],i=new RegExp(`^(last|next)?(${o.join("|")})$`),c=new Date;t=t?String(t).trim():"";let h;if(["y","yesterday"].indexOf(t)>-1&&(t="-1"),i.test(t)){const _=c.getDay(),g=o.indexOf(t.slice(-3)),C=t.slice(0,4),U=C==="last"?-7:C==="next"?7:0,b=g-_+U;b>-1?t="+"+b:t=String(b)}return/^[-|+]\d+$/.test(t)?h=new Date(Date.now()+parseInt(t)*s):n&&this.formatRegExps(n).actualDateMatchRegExp.test(t)?h=this.dateFromFormattedString(t,n):/^\d{1,2}$/.test(t)?(h=new Date,h.setDate(parseInt(t,10))):h=a,h.setHours(0),h.setMinutes(0),h.setSeconds(0),h.setMilliseconds(0),h}}class H{constructor(t={}){x(this,"options",{defaultDuration:30,hourThreshold:5,defaultRate:255,defaultClient:"",defaultProject:"",defaultTask:"",defaultSource:""});x(this,"prefixes",{"@":"clients","#":"tasks","%":"projects","/":"sources"});x(this,"dateTimeHelper");x(this,"version","1.0.0");x(this,"propertyMatcherRegExp");x(this,"durationMatchRegexp",/\+([\d:.]{1,5})/);this.options=j(j({},this.options),t),this.dateTimeHelper=new rt,this.propertyMatcherRegExp=new RegExp(`([${Object.keys(this.prefixes).map(n=>this.options.util.escapeRegExp(n)).join("|")}])([a-zA-Z0-9:_-]+)`,"g"),this.propertyMatcherRegExp=new RegExp("([/#@%])([a-zA-Z0-9:_-]+)","g")}removePropertyFromString(t,n){n=this.options.util.escapeRegExp(n);const a=new RegExp("^"+n+"$|[^\\w]"+n+"[^\\w]|^"+n+"[^\\w]|[^\\w]"+n+"$","ig");return t.replace(a," ")}parse(t,n=!1,a=!1){let s=n,o=a instanceof Date?a:this.dateTimeHelper.parseDate();t=this.dateTimeHelper.convertFormattedDateInString(t,"yyyy-mm-dd",this.options.dateFormat),t=t.replace(/&\s*/,""),/^~[a-f0-9]{16}/.test(t)&&(s=t.slice(1,16),t=t.replace(/~[a-f0-9]{16}/,""));const i=t.match(this.dateTimeHelper.formatRegExps(this.options.dateFormat).dateMatchRegExp);i&&(o=this.dateTimeHelper.parseDate(i[2],this.options.dateFormat,a instanceof Date?a:new Date),t=t.replace(i[0]," "));const c=t.matchAll(this.propertyMatcherRegExp),h={timestamp:+o,hash:s||this.options.util.hash(8),clients:[],tasks:[],description:t,sources:[],projects:[],duration:this.options.defaultDuration,normalized:"",cost:0,rate:this.options.defaultRate,parserVersion:this.version};Array.from(c).forEach(C=>{h[this.prefixes[C[1]]].push(C[2]),h.description=this.removePropertyFromString(h.description,C[0])}),h.clients.length===0&&this.options.defaultClient&&(h.clients=[this.options.defaultClient]),h.projects.length===0&&this.options.defaultProject&&(h.projects=[this.options.defaultProject]),h.tasks.length===0&&this.options.defaultTask&&(h.tasks=[this.options.defaultTask]),h.sources.length===0&&this.options.defaultSource&&(h.sources=[this.options.defaultSource]);const _=t.match(this.durationMatchRegexp);_&&(h.duration=this.dateTimeHelper.parseDuration(_[0].slice(1),this.options.defaultDuration,this.options.hourThreshold),h.description=h.description.replace(_[0]," "));const g=t.match(/\$(\$?)([\d.]{1,6})/);return g?(g[1]==="$"?(h.cost=parseFloat(g[2]),h.rate=null):(h.rate=parseFloat(g[2]),h.cost=this.options.util.costFromRate(h.duration,h.rate)),h.description=this.removePropertyFromString(h.description,g[0])):h.cost=this.options.util.costFromRate(h.duration,this.options.defaultRate),["clients","projects","sources","tasks"].forEach(C=>{h[C].length>1&&(h[C]=[...new Set(h[C])])}),h.normalized=this.normalize(h),h.description=h.description.replace(/^~[a-f0-9]*\s?/,""),h.description=h.description.trim(),h}normalize(t){return["~"+t.hash,"+"+this.options.util.formatDuration(t.duration),":"+this.options.util.formatDate(t.timestamp),t.clients.length>0?"@"+t.clients.join(" @"):null,t.projects.length>0?"%"+t.projects.join(" %"):null,t.sources.length>0?"/"+t.sources.join(" /"):null,t.tasks.length>0?"#"+t.tasks.join(" #"):null,t.rate!==this.options.defaultRate&&t.rate!==null?"$"+String(t.rate):null,t.rate===null?"$$"+t.cost:null,t.description].filter(n=>!!n).join(" ").replace(/[ ]{2,}/g," ")}decoratedParse(t,n=!1){const a=this.parse(t,!1,n),s=/&\s*$/.test(t);return N(j({},a),{usesDefaultClient:a.clients.length===1&&a.clients[0]===this.options.defaultClient&&t.indexOf(a.clients[0])<0,usesDefaultProject:a.projects.length===1&&a.projects[0]===this.options.defaultProject&&t.indexOf(a.projects[0])<0,usesDefaultTask:a.tasks.length===1&&a.tasks[0]===this.options.defaultTask&&t.indexOf(a.tasks[0])<0,usesDefaultSource:a.sources.length===1&&a.sources[0]===this.options.defaultSource&&t.indexOf(a.sources[0])<0,usesDefaultDuration:!t.match(this.durationMatchRegexp),usesDefaultDate:!t.match(this.dateTimeHelper.formatRegExps(this.options.dateFormat).dateMatchRegExp),usesDefaultRate:!t.match(/\$\d+/),isTimer:s})}extend(t,n,a){a=j({normalized:!0,includeSource:!1,stripHash:!0,defaultDate:!1,forceDefaultDateOnDateless:!1},a);let s=typeof t=="string"?this.decoratedParse(t,a.defaultDate):t,o=(typeof n=="string"?[n]:n).map(i=>{i=i.replace(/\*+$/,"");let c=this.decoratedParse(i,a.defaultDate);return["clients","projects","tasks","sources"].forEach(h=>{c[h].length===0&&(c[h]=s[h].slice())}),c.usesDefaultDuration&&s.duration!==c.duration&&(c.duration=s.duration),c.description||(c.description=s.description),!s.usesDefaultDate&&c.usesDefaultDate&&(c.timestamp=s.timestamp),c.usesDefaultDate&&a.forceDefaultDateOnDateless&&(c.timestamp=+a.defaultDate),!s.usesDefaultRate&&c.usesDefaultRate&&(c.rate=s.rate),a.normalized?this.normalize(c).replace(a.stripHash?/^[~a-f0-9]+\s/:"",""):c});return a.includeSource&&(a.normalized?o.unshift(this.normalize(s).replace(a.stripHash?/^[~a-f0-9]+\s/:"","")):o.unshift(s)),o}}class Y{set(t,n){typeof n!="string"&&(n=JSON.stringify(n)),window.localStorage.setItem(t,n)}get(t,n=!1){const a=window.localStorage.getItem(t);return a&&['"',"{","["].indexOf(a[0])>-1?JSON.parse(a):a||n}remove(t){return window.localStorage.removeItem(t),!0}}class K{constructor(t){x(this,"data",{});x(this,"logStore");x(this,"storage");this.logStore=t,this.storage=new Y,this.data=this.storage.get("suggestions"),this.data||(this.data={},this.rebuild())}get(t,n,a=10){let s=[];for(let o=0;o<this.data[t].length&&(this.data[t][o][0].indexOf(n)===0&&s.push(this.data[t][o][0]),s.length!==a);o++);return s}updateFromLog(t){Object.keys(this.data).forEach(n=>{t[n].forEach(a=>this.insert(n,a))}),this.storage.set("suggestions",this.data)}insert(t,n){for(let a=0;a<this.data[t].length;a++)if(this.data[t][a][0]===n){this.data[t][a][1]++,this.reorder(t);return}this.data[t].push([n,1]),this.reorder(t)}rebuild(){const t={clients:{},projects:{},tasks:{},sources:{}},n=(a,s)=>{if(s in t[a]){t[a][s]++;return}t[a][s]=1};this.logStore.data.forEach(a=>{a.clients.forEach(s=>n("clients",s)),a.tasks.forEach(s=>n("tasks",s)),a.projects.forEach(s=>n("projects",s)),a.sources.forEach(s=>n("sources",s))}),Object.keys(t).forEach(a=>{let s=[];for(const o in t[a])s.push([o,t[a][o]]);this.data[a]=s,this.reorder(a)}),this.storage.set("suggestions",this.data)}reorder(t){this.data[t].sort((n,a)=>a[1]-n[1])}}const ti={},ei={xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},si=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1),ni=[si];function oi(r,t){return l(),d("svg",ei,ni)}var ii=k(ti,[["render",oi]]);class tt{constructor(t,n){x(this,"timers");x(this,"storage");x(this,"timelogParser");this.storage=t;let a=this.storage.get("timers",[]);this.timers=a.map(s=>N(j({},s),{started:new Date(s.started)})),this.timelogParser=n}getTimers(){return this.timers}setTimer(t){this.timers.unshift({started:new Date,timelog:t,minutes:0,state:"running"}),this.storeTimers()}storeTimers(){this.storage.set("timers",this.timers)}delete(t){t=typeof t=="string"?this.hashToIndex(t):t,this.end(t)}end(t){t=typeof t=="string"?this.hashToIndex(t):t;let n=this.timers[t],a=n.timelog,s=this.duration(n.started);return a.duration=Math.round(s)+n.minutes,a.duration===0&&(a.duration=this.timelogParser.options.defaultDuration),a.normalized=this.timelogParser.normalize(a),this.timers.splice(t,1),this.storeTimers(),a}pause(t){t=typeof t=="string"?this.hashToIndex(t):t,this.timers[t].state="paused",this.timers[t].minutes+=this.duration(this.timers[t].started),this.storeTimers()}unpause(t){t=typeof t=="string"?this.hashToIndex(t):t,this.timers[t].state="running",this.timers[t].started=new Date,this.storeTimers()}toggle(t){this.timers[t].state==="running"?this.pause(t):this.unpause(t)}duration(t){return Math.round((Date.now()-+t)/6e4)}hashToIndex(t){return this.timers.map(n=>n.timelog.hash).indexOf(t)}}const ri={components:{QuestionMark:ii},inject:["util","globalStore","settings"],props:{parser:H,logStore:q,suggestionProvider:K,timers:tt},data(){return{inputIsMultiple:!1,inputIsMultipleExtend:!1,currentLog:null,placeholder:"",previewString:"",logString:"",suggestMatcher:/([@|#|\/|%])([a-z0-9:_-]{1,})$/mi,suggestions:[],suggestionIndex:0,currentSuggestFragment:null,prefixes:{"@":"clients","#":"tasks","%":"projects","/":"sources"}}},mounted(){this.setPlaceholder()},watch:{logString:function(r,t){this.inputIsMultipleExtend=r.indexOf("****")>-1,this.inputIsMultiple=r.indexOf("----")>-1}},methods:{setPlaceholder(){const r=["what's poppin' kermit?","what do?","what have you been up to?","what's happening?","\u231A\u{1F914}","do you remember anything at all?","any recollection?","think...","something something video call"];this.placeholder=r[Math.floor(Math.random()*r.length)]},keyDown(r){if(["Tab","Enter"].indexOf(r.key)>-1&&this.suggestions.length>0){this.insertSuggestion(),r.preventDefault();return}if(["ArrowDown","ArrowUp"].indexOf(r.key)>-1&&this.suggestions.length>0){const t=this.suggestions.length;let n=parseInt(this.suggestionIndex);r.key==="ArrowDown"?(n++,n>=t&&(n=0)):(n--,n<0&&(n=t-1)),this.suggestionIndex=n,r.preventDefault()}},keyUp(r){const t=this.logString,n=this.$refs.textarea.selectionStart,a=t.substr(0,n),s=Math.max(a.lastIndexOf(" "),0),o=a.substr(s,n),i=o.match(this.suggestMatcher);if(r.key==="Enter"&&r.ctrlKey&&this.settings.storeOnControlEnter){this.storeCurrentLog();return}["ArrowDown","ArrowUp"].indexOf(r.key)>-1&&this.currentSuggestFragment!==null||(i?(this.suggestionIndex=0,this.currentSuggestFragment=i[2],this.suggestions=this.suggestionProvider.get(this.prefixes[i[1]],i[2])):this.unsetSuggestions(),this.setPreview())},setPreview(){if(this.settings.showParsePreviewOnType){const r=this.logString.split(/----|\*\*\*\*/),t=this.parser.decoratedParse(r[0],this.settings.defaultDateInsideSelection?this.globalStore.defaultDate:!1);this.previewString=`
                <span class="${this.currentLog?"d-none":""}">Preview:</span>
                <span class="${this.currentLog?"text-info":"d-none"}">Editing:</span>
                <span class="${t.clients.length===0?"d-none":""} ${t.usesDefaultClient?"fst-italic":""}">${this.util.join(t.clients,"@")}</span>
                <span class="${t.projects.length===0?"d-none":""} ${t.usesDefaultProject?"fst-italic":""}">${this.util.join(t.projects,"%")}</span>
                <span class="${t.tasks.length===0?"d-none":""} ${t.usesDefaultTask?"fst-italic":""}">${this.util.join(t.tasks,"#")}</span>
                <span class="${t.sources.length===0?"d-none":""} ${t.usesDefaultSource?"fst-italic":""}">${this.util.join(t.sources,"/")}</span>
                <span class="${t.usesDefaultDuration?"fst-italic":""}">${this.util.formatDuration(t.duration)}</span>
                <span class="${t.usesDefaultDate?"fst-italic":""}">${this.util.formatDate(t.timestamp,this.settings.dateFormat)}</span>
                <span>${t.description}</span>
            `,r.length>1&&(this.previewString+=`<span class="fw-bold">and ${r.length-1} more</span>`)}},afterProcessing(){this.settings.clearTimeLogOnStore&&(this.logString="",this.previewString=null,this.currentLog=!1,this.inputIsMultiple=!1,this.inputIsMultipleExtend=!1),this.$emit("reload-table"),this.$emit("after-insert"),this.setPlaceholder(),this.unsetSuggestions()},setTimer(){let r=this.logString.split("----");r[0].trim().length!==0&&(r.forEach(t=>{let n=this.parser.parse(t);this.timers.setTimer(n)}),this.globalStore.toast("timer created..."),this.afterProcessing())},storeCurrentLogAsMultipleExtend(){const r=this.logString.split("****"),t=this.parser.extend(r[0],r.slice(1),{normalized:!0,includeSource:!0,stripHash:!0,defaultDate:this.settings.defaultDateInsideSelection?this.globalStore.defaultDate:!1});this.logString=t.join("----"),console.log(this.logString),this.storeCurrentLogAsMultiple()},storeCurrentLogAsMultiple(){if(this.logString.length===0)return;let r=this.logString.split("----"),t=0,n=0,a=0;r.forEach(s=>{if(s.trim().length===0)return;let o=this.parser.parse(s,!1,this.settings.defaultDateInsideSelection?this.globalStore.defaultDate:!1);if(/&\s*$/.test(s))this.timers.setTimer(o),this.suggestionProvider.updateFromLog(o),a++;else{this.logStore.insert(o),this.suggestionProvider.updateFromLog(o);let i=new Date(o.timestamp);(i<this.globalStore.lowerDate||i>this.globalStore.upperDate)&&n++,t++}}),t>0&&t-n>0&&this.globalStore.toast(`${t-n} logs saved...`),n>0&&this.globalStore.toast(`${n} logs saved outside of current date range...`),a>0&&this.globalStore.toast(`${a} timers created...`),this.afterProcessing()},applyHistoryExpansions(){const r=/----/.test(this.logString)?"----":"****";this.logString=this.logString.split(r).map(t=>{const n=t.match(/^!!?(\d+)/),a=t.match(/^!!?([a-f0-9]{2,})/),s=t.slice(0,2)!=="!!";let o=null;if(!!n&&!a){const i=parseInt(n[1])-1,c=this.logStore.currentSelection.indexToLogMap[i];c&&this.logStore.currentSelection.days[c[0]]&&this.logStore.currentSelection.days[c[0]].logs[c[1]]&&(o=this.logStore.currentSelection.days[c[0]].logs[c[1]],t=t.replace(/^!!?\d+\s*/,""))}if(a){const i=a[1].length;o=this.logStore.data.find(c=>c.hash.slice(0,i)===a[1]),o&&(t=t.replace(/^!!?([a-f0-9]{2,})/,""))}return o&&(t=this.parser.extend(o,t,{normalized:!0,includeSource:!1,stripHash:!0,defaultDate:this.settings.defaultDateInsideSelection?this.globalStore.defaultDate:!1,forceDefaultDateOnDateless:s})),t}).join(r)},storeCurrentLog(){if(this.logString.length===0)return;if(this.applyHistoryExpansions(),!this.currentLog&&this.inputIsMultipleExtend){this.storeCurrentLogAsMultipleExtend();return}if(!this.currentLog&&this.inputIsMultiple){this.storeCurrentLogAsMultiple();return}if(/&\s*$/.test(this.logString)){this.setTimer();return}let r;if(this.currentLog)r=this.parser.parse(this.logString),r.timestamp!==this.currentLog.timestamp?(this.settings.keepOriginalLogOnEdit||this.logStore.delete(this.currentLog),this.logStore.insert(r)):(r=this.parser.parse(this.logString,this.currentLog.hash),this.logStore.update(r)),this.globalStore.toast("log updated...");else{r=this.parser.parse(this.logString,!1,this.settings.defaultDateInsideSelection?this.globalStore.defaultDate:!1),this.logStore.insert(r);let t=new Date(r.timestamp);t<this.globalStore.lowerDate||t>this.globalStore.upperDate?this.globalStore.toast("log saved outside of current date range..."):this.globalStore.toast("log saved...")}this.suggestionProvider.updateFromLog(r),this.afterProcessing()},insertSuggestion(){const r=this.logString,t=this.$refs.textarea.selectionStart,n=r.substr(0,t),a=n.replace(new RegExp(this.currentSuggestFragment+"$"),this.suggestions[this.suggestionIndex]+" "),s=a.length-n.length;this.suggestions=[],this.suggestionIndex=0,this.currentSuggestFragment=null,this.logString=r.replace(n,a),this.$refs.textarea.selectionStart=t+s,this.$refs.textarea.selectionEnd=t+s,this.$refs.textarea.focus(),this.setPreview()},unsetSuggestions(){this.suggestionIndex=0,this.currentSuggestFragment=null,this.suggestions=[]},editLog(r){this.unsetSuggestions(),this.currentLog=r,this.logString=this.currentLog.normalized.replace(/^~[a-f0-9 ]*/,""),this.logString=this.parser.dateTimeHelper.convertFormattedDateInString(this.logString,"yyyy-mm-dd",this.settings.dateFormat),this.$refs.textarea.focus(),this.$nextTick(()=>{this.setPreview()})}}},et=r=>(yt("data-v-2e444a22"),r=r(),wt(),r),ai={class:"row"},li={class:"col-12"},di={class:"row g-0"},ci={class:"col-9 col-xl-10"},ui={class:"position-relative"},hi=["placeholder"],pi={class:"col-3 col-xl-2"},mi={class:"btn-group w-100 h-100"},gi=et(()=>e("span",{class:"d-none d-lg-inline fs-4"},"Store",-1)),fi=et(()=>e("span",{class:"d-lg-none"},"Store",-1)),_i=[gi,fi],bi=et(()=>e("button",{type:"button",class:"btn btn-info dropdown-toggle dropdown-toggle-split","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",{class:"visually-hidden"},"Toggle Dropdown")],-1)),yi={class:"dropdown-menu"},wi={class:"col-12"},vi=["innerHTML"],ki={class:"position-relative"},xi={class:"list-group position-absolute top-100 w-100",style:{"z-index":"999"}};function Si(r,t,n,a,s,o){const i=v("QuestionMark");return l(),d("div",ai,[e("div",li,[e("div",di,[e("div",ci,[e("div",ui,[m(e("textarea",{class:"form-control form-control-lg",placeholder:s.placeholder,id:"timelog",style:{height:"100px"},ref:"textarea",onKeydown:t[0]||(t[0]=c=>o.keyDown(c)),onKeyup:t[1]||(t[1]=c=>o.keyUp(c)),"onUpdate:modelValue":t[2]||(t[2]=c=>s.logString=c)},null,40,hi),[[w,s.logString]]),o.settings.showHelpIcon?(l(),d("button",{key:0,class:"btn btn-icon position-absolute end-0 top-0",onClick:t[3]||(t[3]=c=>r.$emit("show-help"))},[D(i)])):f("",!0)])]),e("div",pi,[e("div",mi,[e("button",{id:"storeButton",type:"button",class:"btn btn-info w-100 h-100",title:"ctrl + enter",onClick:t[4]||(t[4]=y((...c)=>o.storeCurrentLog&&o.storeCurrentLog(...c),["stop","prevent"]))},_i),bi,e("ul",yi,[e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:t[5]||(t[5]=y((...c)=>o.setTimer&&o.setTimer(...c),["prevent","stop"]))},"Start timer")])])])]),e("div",wi,[s.logString.length>0?(l(),d("p",{key:0,class:"small mb-0",innerHTML:s.previewString},null,8,vi)):f("",!0),e("div",ki,[e("ul",xi,[(l(!0),d($,null,F(s.suggestions,(c,h)=>(l(),d("li",{class:I(["list-group-item list-group-item-action",{active:h===s.suggestionIndex}]),onClick:t[6]||(t[6]=y((..._)=>o.insertSuggestion&&o.insertSuggestion(..._),["stop","prevent"]))},p(c),3))),256))])])])])])])}var Di=k(ri,[["render",Si],["__scopeId","data-v-2e444a22"]]);const Ci={},Ti={xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},Ii=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2"},null,-1),$i=[Ii];function Li(r,t){return l(),d("svg",Ti,$i)}var Fi=k(Ci,[["render",Li]]);const Ri={},Mi={xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},Ei=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"},null,-1),Ui=[Ei];function Pi(r,t){return l(),d("svg",Mi,Ui)}var ji=k(Ri,[["render",Pi]]);const Oi={},Vi={xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},Ai=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},null,-1),Bi=[Ai];function Hi(r,t){return l(),d("svg",Vi,Bi)}var at=k(Oi,[["render",Hi]]);const zi={},Ni={xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},qi=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"},null,-1),Yi=[qi];function Ki(r,t){return l(),d("svg",Ni,Yi)}var Qi=k(zi,[["render",Ki]]);const Ji={},Wi={xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},Gi=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 19l-7-7 7-7"},null,-1),Zi=[Gi];function Xi(r,t){return l(),d("svg",Wi,Zi)}var tr=k(Ji,[["render",Xi]]);const er={},sr={xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},nr=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 5l7 7-7 7"},null,-1),or=[nr];function ir(r,t){return l(),d("svg",sr,or)}var rr=k(er,[["render",ir]]);const ar={inject:["util","settings"],props:{tableData:{}},data(){return{cols:{date:!0,clients:!0,projects:!0,tasks:!0,sources:!0,description:!0,cost:this.settings.showCostColumn,rate:this.settings.showCostColumn,duration:!0},modal:null}},computed:{name(){return this.util.escapeStringForFilename(this.settings.filenameTemplate.replace("%s",this.util.formatDateRangeByFormat(this.tableData.range.lower,this.tableData.range.upper,this.settings.dateRangeFormat)))},defaultName(){return this.util.escapeStringForFilename(this.settings.filenameTemplate.replace("%s",this.util.formatDateRangeByFormat(this.tableData.range.lower,this.tableData.range.upper,this.settings.dateRangeFormat)))},rows(){return this.tableData.days.reduce((r,t)=>{let n=this.util.formatDate(t.date,this.settings.dateFormat);return r.push(...t.logs.map(a=>{let s=[];return this.cols.date&&s.push(n),this.cols.clients&&s.push(this.util.join(a.clients)),this.cols.projects&&s.push(this.util.join(a.projects)),this.cols.tasks&&s.push(this.util.join(a.tasks)),this.cols.sources&&s.push(this.util.join(a.sources)),this.cols.description&&s.push(a.description),this.cols.cost&&s.push(this.util.formatAmount(a.cost,this.settings.currencyFormat)),this.cols.rate&&s.push(this.util.formatAmount(a.rate,this.settings.currencyFormat)+"/hr"),this.cols.duration&&s.push(this.util.formatDuration(a.duration)),s})),r},[this.columnTitles])},columnTitles(){return Object.keys(this.cols).filter(r=>this.cols[r])}},mounted(){this.modal=new B(this.$refs.modal)},methods:{download(r){const t=new X.book_new,n={},a=this.util.escapeStringForFilename(this.name||this.defaultName);r==="csv"&&(n.forceQuotes=!0),t.Props={Title:a,CreatedDate:new Date};let s=X.aoa_to_sheet(this.rows);X.book_append_sheet(t,s,a,!0),vt(t,`${a}.${r}`,n)}}},lr={class:"modal fade",ref:"modal",id:"download","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"downloadLabel","aria-hidden":"true"},dr={class:"modal-dialog modal-dialog-scrollable modal-fullscreen-md-down"},cr={class:"modal-content"},ur=e("div",{class:"modal-header"},[e("h5",{class:"modal-title fw-light",id:"downloadLabel"},"Download"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),hr={class:"modal-body"},pr={key:0,class:"alert alert-info"},mr={key:1},gr={class:"mb-3"},fr=e("label",{for:"filename",class:"form-label"},"Filename",-1),_r={class:"form-check form-switch mb-2"},br=["id","onUpdate:modelValue"],yr=["for"],wr=u(" include "),vr=u(" column "),kr={key:0,class:"modal-footer"};function xr(r,t,n,a,s,o){return l(),d("div",lr,[e("div",dr,[e("div",cr,[ur,e("div",hr,[o.rows.length===1?(l(),d("p",pr,"No rows to download, please adjust the filters.")):(l(),d("div",mr,[e("div",gr,[fr,m(e("input",{type:"text",class:"form-control",id:"filename","onUpdate:modelValue":t[0]||(t[0]=i=>o.name=i)},null,512),[[w,o.name]])]),(l(!0),d($,null,F(s.cols,(i,c)=>(l(),d("div",_r,[m(e("input",{class:"form-check-input setting",type:"checkbox",value:"",id:`col-${c}`,"onUpdate:modelValue":h=>s.cols[c]=h},null,8,br),[[T,s.cols[c]]]),e("label",{class:"form-check-label",for:`col-${c}`},[wr,e("code",null,p(c),1),vr],8,yr)]))),256))]))]),o.rows.length>1?(l(),d("div",kr,[e("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=y(i=>o.download("csv"),["stop","prevent"]))},"CSV"),e("button",{type:"button",class:"btn btn-primary",onClick:t[2]||(t[2]=y(i=>o.download("xlsx"),["stop","prevent"]))},"XLSX"),e("button",{type:"button",class:"btn btn-primary",onClick:t[3]||(t[3]=y(i=>o.download("ods"),["stop","prevent"]))},"ODS"),e("button",{type:"button",class:"btn btn-primary",onClick:t[4]||(t[4]=y(i=>o.download("txt"),["stop","prevent"]))},"TXT")])):f("",!0)])])],512)}var Sr=k(ar,[["render",xr]]);const Dr={},Cr={xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},Tr=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"},null,-1),Ir=[Tr];function $r(r,t){return l(),d("svg",Cr,Ir)}var lt=k(Dr,[["render",$r]]);const Lr={inject:["settings"],components:{CloseButton:lt},props:{suggestionProvider:K,tableData:{}},mounted(){this.modal=new B(this.$refs.modal),this.isFiltered&&this.apply()},data(){let r=new URL(window.location),t={clients:[],projects:[],tasks:[],sources:[]},n=!1;return["clients","projects","tasks","sources"].forEach(a=>{r.searchParams.has(a)&&(t[a]=r.searchParams.get(a).split(","),n=!0)}),{filterKeys:Object.keys(t),filters:t,isFiltered:n}},methods:{toggleFilter(r,t,n=!1){this.filters[r].indexOf(t)>-1?this.filters[r].splice(this.filters[r].indexOf(t),1):this.filters[r].push(t),n&&this.apply()},apply(){this.$emit("update-filters",this.filters),this.settings.closeFiltersOnApply&&this.modal.hide()},clear(){this.filters={clients:[],projects:[],tasks:[],sources:[]},this.apply()}}},Fr={class:"modal fade",ref:"modal",id:"filters","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"filtersLabel","aria-hidden":"true"},Rr={class:"modal-dialog modal-dialog-scrollable modal-fullscreen-md-down"},Mr={class:"modal-content"},Er=e("div",{class:"modal-header"},[e("h5",{class:"modal-title fw-light",id:"filtersLabel"},"Filters"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ur={class:"modal-body"},Pr={class:"accordion",id:"filterAccordion"},jr={key:0,class:"accordion-item"},Or=["id"],Vr=["data-bs-target","aria-controls"],Ar=["id","aria-labelledby"],Br={class:"accordion-body"},Hr=["for"],zr=["onChange","checked","id"],Nr=["for"],qr=["onChange","checked","id"],Yr={class:"modal-footer"};function Kr(r,t,n,a,s,o){return l(),d("div",Fr,[e("div",Rr,[e("div",Mr,[Er,e("div",Ur,[e("div",Pr,[(l(!0),d($,null,F(s.filterKeys,(i,c)=>(l(),d($,null,[n.suggestionProvider.data[i].length+n.tableData.matchedProperties[i].length>0?(l(),d("div",jr,[e("h2",{class:"accordion-header",id:`heading${c}`},[e("button",{class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":`#collapse${c}`,"aria-expanded":"false","aria-controls":`collapse${c}`},p(i)+" ("+p(s.filters[i].length)+" / "+p(n.tableData.matchedProperties[i].length)+" ) ",9,Vr)],8,Or),e("div",{id:`collapse${c}`,class:"accordion-collapse collapse","aria-labelledby":`heading${c}`,"data-bs-parent":"#filterAccordion"},[e("div",Br,[(l(!0),d($,null,F(n.tableData.matchedProperties[i],(h,_)=>(l(),d("label",{class:"border border-primary rounded p-1 d-inline-block me-2 small",for:`cb-filter-current-${i}-${_}`},[e("input",{onChange:g=>o.toggleFilter(i,h),checked:s.filters[i].indexOf(h)>-1,class:"form-check-input",type:"checkbox",value:"",id:`cb-filter-current-${i}-${_}`},null,40,zr),u(" "+p(h),1)],8,Hr))),256)),(l(!0),d($,null,F(n.suggestionProvider.data[i],(h,_)=>(l(),d($,null,[n.tableData.matchedProperties[i].indexOf(h[0])===-1?(l(),d("label",{key:0,class:"border border-primary rounded p-1 d-inline-block me-2 small",for:`cb-filter-other-${i}-${_}`},[e("input",{onChange:g=>o.toggleFilter(i,h[0]),checked:s.filters[i].indexOf(h[0])>-1,class:"form-check-input",type:"checkbox",value:"",id:`cb-filter-other-${i}-${_}`},null,40,qr),u(" "+p(h[0]),1)],8,Nr)):f("",!0)],64))),256))])],8,Ar)])):f("",!0)],64))),256))])]),e("div",Yr,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[0]||(t[0]=y((...i)=>o.clear&&o.clear(...i),["stop","prevent"]))},"Clear all"),e("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=y((...i)=>o.apply&&o.apply(...i),["stop","prevent"]))},"Apply filters")])])])],512)}var Qr=k(Lr,[["render",Kr]]);const Jr={inject:["util","globalStore","settings"],components:{CloseButton:lt,DownloadDialog:Sr,ChevronRight:rr,ChevronLeft:tr,DotsVertical:Qi,DeleteLog:at,EditLog:ji,DuplicateLog:Fi,FilterDialog:Qr},props:{logStore:q,logParser:H,suggestionProvider:K},data(){let r=this.util.dateRange("week",this.util.formatDate(new Date)),t=new URL(window.location),n=t.searchParams.get("from"),a=t.searchParams.get("to"),s={},o=!1,i=["week","month","custom"].includes(t.searchParams.get("mode"))?t.searchParams.get("mode"):"week";if(/^\d\d\d\d-\d\d-\d\d$/.test(n)&&/^\d\d\d\d-\d\d-\d\d$/.test(n)){let c=new Date(n);(+new Date(a)-+c)/(24*60*60*1e3)<7&&(c=new Date(+c-7*24*60*60*1e3)),r={lowerUS:n,upperUS:a,lower:new Date(n),upper:new Date(a),next:a,prev:this.util.formatDate(c)}}return{isFiltered:o,filters:s,dateMode:i,fromDate:r.lowerUS,toDate:r.upperUS,nextDate:r.next,prevDate:r.prev,tableData:this.logStore.get(r.lower,r.upper,{}),extrasOpen:!1,skipNextToWatch:!1,prefixPropertyMap:{clients:"@",tasks:"#",projects:"%",sources:"/"}}},watch:{fromDate:function(){if(this.dateMode==="week"){const r=new Date(this.fromDate),t=r.getDay();t!==1&&r.setDate(r.getDate()+(t===0?-6:1-t)),this.fromDate=this.util.formatDate(r),this.toDate=this.util.formatDate(r.setDate(r.getDate()+6))}else if(this.dateMode==="month"){let r=new Date(this.fromDate);r.setDate(1),this.fromDate=this.util.formatDate(r),r.setMonth(r.getMonth()+1),r.setHours(-6),this.toDate=this.util.formatDate(r)}}},mounted(){this.updateTableData()},methods:{getIndex(r,t){return this.logStore.currentSelection.logIndexToIndexMap[r]?this.logStore.currentSelection.logIndexToIndexMap[r][t]+1:0},updateURL(){let r=new URL(window.location);r.searchParams.set("from",this.util.formatDate(this.fromDate)),r.searchParams.set("to",this.util.formatDate(this.toDate)),r.searchParams.set("mode",this.dateMode),Object.entries(this.filters).forEach(t=>{t[1].length>0?r.searchParams.set(t[0],t[1]):r.searchParams.delete(t[0])}),history.replaceState({},null,r.toString())},toggleFilter(r,t,n=!1){this.$refs.filterDialog.toggleFilter(r,t,n)},clearFilters(){this.$refs.filterDialog.clear()},showFilters(){this.$refs.filterDialog.modal.show()},changeDateMode(){if(this.dateMode!=="custom"){this.gotoDate(this.fromDate);return}let r=new Date,t;r.setDate(1),t=new Date(r),t.setMonth(t.getMonth()+1),t.setHours(-1),this.fromDate=this.util.formatDate(r),this.toDate=this.util.formatDate(t),this.updateTableData()},setFilters(r){this.filters=r,this.isFiltered=Object.values(r).some(t=>t.length>0),this.updateTableData()},gotoDate(r){const t=this.util.dateRange(this.dateMode,this.util.formatDate(new Date(r)));this.fromDate=t.lowerUS,this.toDate=t.upperUS,this.nextDate=t.next,this.prevDate=t.prev,this.updateTableData()},updateTableData(){this.fromDate===""&&this.toDate!==""&&(this.fromDate=this.toDate),this.fromDate!==""&&this.toDate===""&&(this.toDate=this.fromDate);const r=new Date(this.fromDate),t=new Date(this.toDate);r>t&&(this.toDate=this.fromDate),this.updateURL(),t.setHours(0),this.globalStore.defaultDate=Date.now()<t&&Date.now()>r?void 0:t,this.globalStore.upperDate=t,this.globalStore.lowerDate=r,this.tableData=this.logStore.get(new Date(this.fromDate),new Date(this.toDate),this.filters)},totalCellColspan(){return 1+ +this.settings.showClientColumn+ +this.settings.showProjectColumn+ +this.settings.showTaskColumn+ +this.settings.showSourceColumn},dayTotalTime(r){return r.reduce((t,n)=>t+n.duration,0)},dayTotalCost(r){return r.reduce((t,n)=>t+this.util.costFromRate(n.duration,n.rate),0)},totalTime(){return this.tableData.days.reduce((r,t)=>r+t.total,0)},totalCost(){return this.tableData.days.reduce((r,t)=>r+t.cost,0)},deleteLog(r,t){this.logStore.delete(this.tableData.days[r].logs[t]),this.updateTableData(),this.$emit("hide-suggestions"),this.globalStore.toast("log deleted...")},duplicateLog(r,t){this.logStore.insert(this.logParser.parse(this.tableData.days[r].logs[t].normalized.replace(/^~[a-f0-9 ]*/,""))),this.updateTableData(),this.$emit("hide-suggestions"),this.globalStore.toast("log duplicated...")},editLog(r,t){this.$emit("edit-log",this.tableData.days[r].logs[t])}}},Wr={class:"row g-0"},Gr={class:"col-12 mt-3"},Zr={class:"display-6 text-center fw-light"},Xr={class:"col-12 d-flex justify-content-between my-3"},ta={key:0,class:"btn-group btn-group-sm h-100 me-1 me-lg-3",role:"group"},ea={class:"btn-group btn-group-sm max-w-50",role:"group"},sa=e("option",{value:"week"},"week",-1),na=e("option",{value:"month"},"month",-1),oa=e("option",{value:"custom"},"custom",-1),ia=[sa,na,oa],ra=e("option",{value:"week"},"wk",-1),aa=e("option",{value:"month"},"mo",-1),la=e("option",{value:"custom"},"cu",-1),da=[ra,aa,la],ca={class:"dropdown"},ua=e("button",{class:"btn btn-sm btn-secondary dropdown-toggle",type:"button",id:"filters-and-download","data-bs-reference":"parent","data-bs-toggle":"dropdown","aria-expanded":"false"},null,-1),ha={class:"dropdown-menu","aria-labelledby":"filters-and-download"},pa={key:0,class:"col-12"},ma={class:"btn-group btn-group-sm mb-2 me-2"},ga=["onClick"],fa={class:"col-12"},_a={key:0,class:"alert alert-info my-5"},ba={class:"display-6"},ya={class:"table-responsive"},wa={class:"table table-sm"},va={key:0},ka=e("span",{class:"text-primary"},"!",-1),xa=[ka],Sa={key:1},Da=e("span",{class:"d-none d-lg-inline"},[u("Client "),e("span",{class:"text-primary"},"@")],-1),Ca=e("span",{class:"d-inline d-lg-none"},"Clt",-1),Ta=[Da,Ca],Ia={key:2},$a=e("span",{class:"d-none d-lg-inline"},[u("Project "),e("span",{class:"text-primary"},"%")],-1),La=e("span",{class:"d-inline d-lg-none"},"Prj",-1),Fa=[$a,La],Ra={key:3},Ma=u(" Task "),Ea=e("span",{class:"d-none d-lg-inline text-primary"},"#",-1),Ua=[Ma,Ea],Pa={key:4},ja=e("span",{class:"d-none d-lg-inline"},[u("Source "),e("span",{class:"text-primary"},"/")],-1),Oa=e("span",{class:"d-inline d-lg-none"},"Src",-1),Va=[ja,Oa],Aa=e("th",null,[e("span",{class:"d-none d-lg-inline"},"Description"),e("span",{class:"d-inline d-lg-none"},"Dsc")],-1),Ba={key:5},Ha=e("th",null,[e("span",{class:"d-none d-lg-inline"},"Duration"),e("span",{class:"d-inline d-lg-none"},"Dur")],-1),za={key:6},Na=e("th",null,null,-1),qa=e("th",null,null,-1),Ya={key:0},Ka={key:1},Qa={key:2},Ja={key:3},Wa={key:4},Ga={key:5},Za={key:6,class:"text-end"},Xa=["onClick"],tl={class:"text-end"},el=["onClick"],sl={class:"text-end"},nl=["onClick"],ol=["colspan"],il=["innerHTML"],rl=["colspan"];function al(r,t,n,a,s,o){const i=v("ChevronLeft"),c=v("ChevronRight"),h=v("DuplicateLog"),_=v("EditLog"),g=v("DeleteLog"),C=v("DownloadDialog"),U=v("FilterDialog");return l(),d("div",null,[e("div",Wr,[e("div",Gr,[e("h2",Zr,[u(p(o.util.formatDateRangeByFormat(s.fromDate,s.toDate,o.settings.dateRangeFormat))+" ("+p(o.util.formatDuration(o.totalTime()))+") ",1),o.settings.showCostColumn?(l(),d($,{key:0},[],64)):f("",!0)])]),e("div",Xr,[e("div",null,[s.dateMode!=="custom"?(l(),d("div",ta,[e("button",{type:"button",class:"btn btn-outline-primary btn-icon",onClick:t[0]||(t[0]=b=>this.gotoDate(this.prevDate)),id:"range-prev"},[D(i)]),e("button",{type:"button",class:"btn btn-outline-primary btn-icon",onClick:t[1]||(t[1]=b=>this.gotoDate(this.nextDate)),id:"range-next"},[D(c)])])):f("",!0),e("div",ea,[m(e("input",{class:"btn btn-outline-primary px-0",type:"date","onUpdate:modelValue":t[2]||(t[2]=b=>s.fromDate=b),onChange:t[3]||(t[3]=(...b)=>o.updateTableData&&o.updateTableData(...b))},null,544),[[w,s.fromDate]]),s.dateMode==="custom"?m((l(),d("input",{key:0,class:"btn btn-outline-primary px-0",type:"date","onUpdate:modelValue":t[4]||(t[4]=b=>s.toDate=b),onChange:t[5]||(t[5]=(...b)=>o.updateTableData&&o.updateTableData(...b))},null,544)),[[w,s.toDate]]):f("",!0)]),m(e("select",{class:"ms-1 ms-lg-3 d-none d-lg-inline-block btn btn-outline-primary btn-sm","onUpdate:modelValue":t[6]||(t[6]=b=>s.dateMode=b),onChange:t[7]||(t[7]=(...b)=>o.changeDateMode&&o.changeDateMode(...b))},ia,544),[[nt,s.dateMode]]),m(e("select",{class:"ms-2 px-0 d-lg-none btn btn-outline-primary btn-sm","onUpdate:modelValue":t[8]||(t[8]=b=>s.dateMode=b),onChange:t[9]||(t[9]=(...b)=>o.changeDateMode&&o.changeDateMode(...b))},da,544),[[nt,s.dateMode]])]),e("div",ca,[ua,e("ul",ha,[e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:t[10]||(t[10]=y(b=>r.$refs.filterDialog.modal.show(),["stop","prevent"]))},"Filter Data")]),e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:t[11]||(t[11]=y(b=>r.$refs.downloadDialog.modal.show(),["stop","prevent"]))},"Download")])])])]),s.isFiltered?(l(),d("div",pa,[e("div",ma,[e("button",{class:"btn btn-outline-primary btn-sm",onClick:t[12]||(t[12]=(...b)=>o.showFilters&&o.showFilters(...b))},"Change filters "),e("button",{class:"btn btn-outline-primary btn-sm",onClick:t[13]||(t[13]=(...b)=>o.clearFilters&&o.clearFilters(...b))},"Clear all")]),(l(!0),d($,null,F(s.filters,(b,L)=>(l(),d($,null,[(l(!0),d($,null,F(b,(S,M)=>(l(),d("button",{type:"button",class:"btn btn-sm btn-outline-info me-2 mb-2",onClick:V=>o.toggleFilter(L,S,!0)}," \xD7 "+p(s.prefixPropertyMap[L])+p(S),9,ga))),256))],64))),256))])):f("",!0),e("div",fa,[s.tableData.days.length===0?(l(),d("p",_a," no data for given date range ")):(l(!0),d($,{key:1},F(s.tableData.days,(b,L)=>(l(),d("div",null,[e("h3",ba,p(o.util.formatDate(b.date,o.settings.dateFormat)),1),e("div",ya,[e("table",wa,[e("thead",null,[e("tr",null,[o.settings.showIndexColumn?(l(),d("th",va,xa)):f("",!0),o.settings.showClientColumn?(l(),d("th",Sa,Ta)):f("",!0),o.settings.showProjectColumn?(l(),d("th",Ia,Fa)):f("",!0),o.settings.showTaskColumn?(l(),d("th",Ra,Ua)):f("",!0),o.settings.showSourceColumn?(l(),d("th",Pa,Va)):f("",!0),Aa,o.settings.showCostColumn?(l(),d("th",Ba,"Cost")):f("",!0),Ha,o.settings.showDupeButton?(l(),d("th",za)):f("",!0),Na,qa])]),e("tbody",null,[(l(!0),d($,null,F(b.logs,(S,M)=>(l(),d("tr",null,[o.settings.showIndexColumn?(l(),d("td",Ya,p(o.getIndex(L,M)),1)):f("",!0),o.settings.showClientColumn?(l(),d("td",Ka,p(o.util.join(S.clients,"")),1)):f("",!0),o.settings.showProjectColumn?(l(),d("td",Qa,p(o.util.join(S.projects,"")),1)):f("",!0),o.settings.showTaskColumn?(l(),d("td",Ja,p(o.util.join(S.tasks,"")),1)):f("",!0),o.settings.showSourceColumn?(l(),d("td",Wa,p(o.util.join(S.sources,"")),1)):f("",!0),e("td",null,p(S.description||"n/a"),1),o.settings.showCostColumn?(l(),d("td",Ga,p(o.util.formatAmount(S.cost,o.settings.currencyFormat)),1)):f("",!0),e("td",null,p(o.util.formatDuration(S.duration)),1),o.settings.showDupeButton?(l(),d("td",Za,[e("button",{class:"btn btn-link btn-sm btn-icon btn-dupe",onClick:y(V=>o.duplicateLog(L,M),["stop","prevent"])},[D(h)],8,Xa)])):f("",!0),e("td",tl,[e("button",{class:"btn btn-link btn-sm btn-icon btn-dupe",onClick:y(V=>o.editLog(L,M),["stop","prevent"])},[D(_)],8,el)]),e("td",sl,[e("a",{class:"btn btn-link btn-sm btn-icon btn-dupe",onClick:y(V=>o.deleteLog(L,M),["stop","prevent"])},[D(g)],8,nl)])]))),256))]),e("tfoot",null,[e("tr",null,[e("td",{colspan:o.totalCellColspan()},null,8,ol),o.settings.showCostColumn?(l(),d("td",{key:0,innerHTML:o.util.formatCost(o.dayTotalCost(b.logs),o.settings.currencyFormat,o.settings.tax,o.settings.rateIncludesTax)},null,8,il)):f("",!0),e("td",null,p(o.util.formatDuration(o.dayTotalTime(b.logs))),1),e("td",{colspan:o.settings.showDupeButton?3:2},null,8,rl)])])])])]))),256))])]),D(C,{"table-data":s.tableData,ref:"downloadDialog"},null,8,["table-data"]),D(U,{"table-data":s.tableData,"suggestion-provider":n.suggestionProvider,ref:"filterDialog",onUpdateFilters:o.setFilters},null,8,["table-data","suggestion-provider","onUpdateFilters"])])}var ll=k(Jr,[["render",al]]);const dl={inject:["globalStore"],name:"LoadingModal"},cl={key:0,class:"position-fixed top-0 start-0 vh-100 vw-100",style:{"z-index":"4096"}},ul=e("div",{class:"position-absolute top-0 start-0 w-100 h-100 bg-dark opacity-50"},null,-1),hl=e("div",{class:"position-absolute top-50 start-50 translate-middle px-4 py-2 rounded-3 bg-light shadow"},[e("h1",{class:"fw-light display-1"},"\u{1F4FC}")],-1),pl=[ul,hl];function ml(r,t,n,a,s,o){return l(),A(kt,{name:"fade"},{default:O(()=>[o.globalStore.loading?(l(),d("div",cl,pl)):f("",!0)]),_:1})}var gl=k(dl,[["render",ml]]);const fl={},_l={xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},bl=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 6h16M4 12h16M4 18h16"},null,-1),yl=[bl];function wl(r,t){return l(),d("svg",_l,yl)}var vl=k(fl,[["render",wl]]);const kl={components:{MenuToggle:vl}},xl={class:"container"},Sl={class:"row"},Dl={class:"col-12 d-flex justify-content-between"},Cl=e("h1",{class:"fw-lighter"},[e("kbd",null,"TMLG")],-1),Tl={href:"#",class:"h-100 d-block show-menu btn btn-icon","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasControls","aria-controls":"offcanvasControls"};function Il(r,t,n,a,s,o){const i=v("MenuToggle");return l(),d("div",xl,[e("div",Sl,[e("div",Dl,[Cl,e("a",Tl,[D(i)])])])])}var $l=k(kl,[["render",Il]]);const Ll={name:"ImportExportDialog",inject:["settings","util"],props:{timelogStore:q,sync:z,suggestionProvider:K},data(){return{importData:!1,importView:"select",view:"import",modal:null,exports:{settings:!0,syncCredentials:this.sync.hasCredentials,data:!0},imports:{settings:!0,syncCredentials:!0,data:!0}}},mounted(){this.modal=new B(this.$refs.modal),this.$refs.modal.addEventListener("hidden.bs.modal",()=>{this.view="import",this.importView="select",this.importData=null}),this.$refs.fileInput.addEventListener("change",this.handleFileChange.bind(this),!1)},methods:{show(){this.modal.show()},handleFileChange(r){const t=r.target.files[0];t&&fetch(window.URL.createObjectURL(t)).then(n=>n.json()).then(n=>{if(!("includes"in n&&("settings"in n||"data"in n||"syncCredentials"in n)))return this.importView="error";this.importData=n,this.importView="confirm"}).catch(()=>{this.importView="error"})},download(){let r={includes:[]};if(this.exports.settings){const n=JSON.parse(JSON.stringify(j({},this.settings.$state)));r.includes.push("Settings"),r.settings=n}this.exports.data&&(r.includes.push("Data"),r.data=JSON.parse(JSON.stringify(this.timelogStore.data)),r.transactions=JSON.parse(JSON.stringify(this.timelogStore.transactions))),this.exports.syncCredentials&&(r.includes.push("syncCredentials"),r.syncCredentials=JSON.parse(JSON.stringify(this.sync.getCredentials())));let t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(JSON.stringify(r))),t.setAttribute("download",`Timelog Export (${r.includes.join(", ")}).json`),document.body.appendChild(t),t.click(),document.body.removeChild(t)},importFromData(){let r=new Y;this.imports.data&&(r.set("data",this.importData.data),r.set("transactions",this.importData.transactions),r.remove("suggestions")),this.imports.settings&&r.set("settings",this.importData.settings),this.imports.syncCredentials&&(r.set("credentials",this.importData.syncCredentials),r.remove("lastUpdated")),window.location.reload()}}},Fl={class:"modal fade",ref:"modal",id:"importExportModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"importExportModalLabel","aria-hidden":"true"},Rl={class:"modal-dialog modal-lg modal-dialog-scrollable modal-fullscreen-md-down"},Ml={class:"modal-content"},El=e("div",{class:"modal-header"},[e("h5",{class:"modal-title fw-light",id:"importExportModalLabel"},"Import/Export"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ul={class:"modal-body"},Pl={class:"nav nav-tabs",id:"importExportTabs",role:"tablist"},jl={class:"nav-item",role:"presentation"},Ol=["aria-selected"],Vl={class:"nav-item",role:"presentation"},Al=["aria-selected"],Bl={class:"tab-content mt-3",id:"importExportTabsContent"},Hl={key:0},zl=e("label",{for:"importFile",class:"form-label"},"File to import",-1),Nl={ref:"fileInput",class:"form-control form-control-lg",id:"importFile",type:"file",accept:".json"},ql={key:1,class:"alert alert-danger"},Yl=u(" The given file was malformed or does not contain data that can be imported. "),Kl={key:2},Ql={class:"form-check form-switch mb-2"},Jl=["disabled"],Wl=e("label",{class:"form-check-label",for:"import-data"},[u(" Import "),e("code",null,"data"),u(" from given file ")],-1),Gl={class:"form-check form-switch mb-2"},Zl=["disabled"],Xl=e("label",{class:"form-check-label",for:"import-settings"},[u(" Import "),e("code",null,"settings"),u(" from given file ")],-1),td={class:"form-check form-switch mb-2"},ed=["disabled"],sd=e("label",{class:"form-check-label",for:"import-synccredentials"},[u(" Import "),e("code",null,"sync credentials"),u(" from given file ")],-1),nd=e("div",{class:"alert alert-warning"}," Existing data will be wiped! ",-1),od={class:"form-check form-switch mb-2"},id=e("label",{class:"form-check-label",for:"export-data"},[u(" Include "),e("code",null,"data"),u(" in the export. "),e("br"),u(),e("small",null,"Sync Transactions are included as well if they exist.")],-1),rd={class:"form-check form-switch mb-2"},ad=e("label",{class:"form-check-label",for:"export-settings"},[u(" Include "),e("code",null,"settings"),u(" in the export. "),e("br"),u(),e("small",null,"Exporting the settings will restore all your settings when you import.")],-1),ld={class:"form-check form-switch mb-2"},dd=["disabled"],cd=e("label",{class:"form-check-label",for:"export-synccredentials"},[u(" Include "),e("code",null,"sync credentials"),u(" in the export. "),e("br"),e("small",null,"Exporting the settings will restore all your settings when you import.")],-1),ud={key:0,class:"alert alert-warning"},hd=u(" Your password will be stored as "),pd=e("u",null,"plain text",-1),md=u(" in the export file! "),gd=[hd,pd,md],fd={class:"modal-footer d-flex justify-content-center"};function _d(r,t,n,a,s,o){return l(),d("div",Fl,[e("div",Rl,[e("div",Ml,[El,e("div",Ul,[e("ul",Pl,[e("li",jl,[e("button",{class:I(["nav-link",{active:s.view==="import"}]),id:"import-tab","data-bs-toggle":"tab","data-bs-target":"#import",type:"button",role:"tab","aria-controls":"import","aria-selected":s.view==="import",onClick:t[0]||(t[0]=i=>s.view="import")},"Import ",10,Ol)]),e("li",Vl,[e("button",{class:I(["nav-link",{active:s.view==="export"}]),id:"export-tab","data-bs-toggle":"tab","data-bs-target":"#export",type:"button",role:"tab","aria-controls":"export","aria-selected":s.view==="export",onClick:t[1]||(t[1]=i=>s.view="export")},"Export ",10,Al)])]),e("div",Bl,[e("div",{class:I(["tab-pane fade",{active:s.view==="import",show:s.view==="import"}]),id:"import",role:"tabpanel","aria-labelledby":"import-tab"},[s.importView==="select"?(l(),d("div",Hl,[zl,e("input",Nl,null,512)])):s.importView==="error"?(l(),d("div",ql,[Yl,e("a",{href:"#",onClick:t[2]||(t[2]=y(i=>s.importView="select",["stop","prevent"]))},"Try again")])):s.importView==="confirm"?(l(),d("div",Kl,[e("div",Ql,[m(e("input",{disabled:s.importData&&!("data"in s.importData),class:"form-check-input",type:"checkbox",id:"import-data","onUpdate:modelValue":t[3]||(t[3]=i=>s.imports.data=i)},null,8,Jl),[[T,s.imports.data]]),Wl]),e("div",Gl,[m(e("input",{disabled:s.importData&&!("settings"in s.importData),class:"form-check-input",type:"checkbox",id:"import-settings","onUpdate:modelValue":t[4]||(t[4]=i=>s.imports.settings=i)},null,8,Zl),[[T,s.imports.settings]]),Xl]),e("div",td,[m(e("input",{disabled:s.importData&&!("syncCredentials"in s.importData),class:"form-check-input",type:"checkbox",id:"import-synccredentials","onUpdate:modelValue":t[5]||(t[5]=i=>s.imports.syncCredentials=i)},null,8,ed),[[T,s.imports.syncCredentials]]),sd]),nd])):f("",!0)],2),e("div",{class:I(["tab-pane fade",{active:s.view==="export",show:s.view==="export"}]),id:"export",role:"tabpanel","aria-labelledby":"export-tab"},[e("div",od,[m(e("input",{class:"form-check-input",type:"checkbox",id:"export-data","onUpdate:modelValue":t[6]||(t[6]=i=>s.exports.data=i)},null,512),[[T,s.exports.data]]),id]),e("div",rd,[m(e("input",{class:"form-check-input",type:"checkbox",id:"export-settings","onUpdate:modelValue":t[7]||(t[7]=i=>s.exports.settings=i)},null,512),[[T,s.exports.settings]]),ad]),e("div",ld,[m(e("input",{disabled:!n.sync.hasCredentials,class:"form-check-input",type:"checkbox",id:"export-synccredentials","onUpdate:modelValue":t[8]||(t[8]=i=>s.exports.syncCredentials=i)},null,8,dd),[[T,s.exports.syncCredentials]]),cd]),n.sync.hasCredentials&&s.exports.syncCredentials?(l(),d("div",ud,gd)):f("",!0)],2)])]),e("div",fd,[s.view==="export"&&(s.exports.syncCredentials||s.exports.data||s.exports.settings)?(l(),d("button",{key:0,class:"btn btn-outline-primary",onClick:t[9]||(t[9]=(...i)=>o.download&&o.download(...i))},"Download ")):f("",!0),s.importView==="confirm"&&s.view==="import"&&(s.imports.syncCredentials||s.imports.data||s.imports.settings)?(l(),d("button",{key:1,class:"btn btn-outline-primary",onClick:t[10]||(t[10]=(...i)=>o.importFromData&&o.importFromData(...i))},"Import now ")):f("",!0)])])])],512)}var bd=k(Ll,[["render",_d]]);const yd={inject:["util","globalStore","settings"],name:"ImportSyncCredentialsFromURLDialog",props:{sync:z},data(){return{modal:!1,encryptedSyncCredentials:null,syncId:null,server:"",passwordType:"password",password:"",encryptedSyncCredentialsError:!1,decryptedSyncCredentials:null,urlIncludesPassword:!1}},mounted(){this.modal=new B(this.$refs.modal)},methods:{show(){this.encryptedSyncCredentials=new URL(window.location).searchParams.get("encryptedSyncCredentials"),new URL(window.location).searchParams.has("password")&&(this.urlIncludesPassword=!0,this.password=atob(new URL(window.location).searchParams.get("password")),this.passwordType="text");const r=new URL(window.location);r.searchParams.delete("encryptedSyncCredentials"),r.searchParams.delete("password"),window.history.replaceState({},document.title,r.toString()),this.modal.show()},decryptEncryptedPassword(){this.sync.decryptData(this.encryptedSyncCredentials,this.password).then(r=>{try{const t=JSON.parse(r);this.sync.setCredentials(t.server,t.syncId,this.password),this.sync.storeCredentials(),this.globalStore.toast("Sync","Credentials successfully imported!"),this.modal.hide()}catch{this.encryptedSyncCredentialsError=!0}})}}},wd={class:"modal fade",ref:"modal",id:"importSyncCredentials","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"importSyncCredentialsLabel","aria-hidden":"true"},vd={class:"modal-dialog modal-dialog-scrollable modal-fullscreen-md-down"},kd={class:"modal-content"},xd=e("div",{class:"modal-header"},[e("h5",{class:"modal-title fw-light",id:"importSyncCredentialsLabel"}," Import Sync Credentials "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Sd={class:"modal-body"},Dd={class:"row"},Cd={class:"col-12"},Td={key:0,class:"alert alert-warning"},Id={class:"mb-3"},$d=e("label",{for:"password",class:"form-label"},"To import the encrypted syncId, please enter the encryption password you used for that syncId:",-1),Ld={class:"input-group"},Fd=["type"],Rd={key:1,class:"alert alert-danger"},Md={class:"d-flex justify-content-center"},Ed=["disabled"];function Ud(r,t,n,a,s,o){return l(),d("div",wd,[e("div",vd,[e("div",kd,[xd,e("div",Sd,[e("div",Dd,[e("div",Cd,[n.sync.hasCredentials?(l(),d("p",Td," Warning, this browser already has a syncId stored. Proceeding will disconnect from the currently used synchronization and may cause data loss! ")):f("",!0),e("div",Id,[$d,e("div",Ld,[m(e("input",{class:"form-control",type:s.passwordType,autocomplete:"current-password",id:"password","onUpdate:modelValue":t[0]||(t[0]=i=>s.password=i)},null,8,Fd),[[W,s.password]]),e("button",{class:"btn-outline-secondary btn",id:"passwordAddon",onClick:t[1]||(t[1]=i=>s.passwordType=s.passwordType==="password"?"text":"password")},p(s.passwordType==="password"?"show":"hide"),1)])]),s.encryptedSyncCredentialsError?(l(),d("p",Rd," The provided password failed to decrypt the syncId :( ")):f("",!0),e("div",Md,[e("button",{type:"button",class:"btn btn-outline-primary",disabled:!s.password,onClick:t[2]||(t[2]=(...i)=>o.decryptEncryptedPassword&&o.decryptEncryptedPassword(...i))}," Import syncId ",8,Ed)])])])])])])],512)}var Pd=k(yd,[["render",Ud]]);const jd={name:"TabContent",props:{name:String,view:String}},Od=["id"],Vd=["id","aria-labelledby"];function Ad(r,t,n,a,s,o){return l(),d("div",{class:"tab-content mt-3",id:`${n.name}TabsContent`},[e("div",{class:I(["tab-pane fade",{active:n.view===n.name,show:n.view===n.name}]),id:`${n.name}TabsPane`,role:"tabpanel","aria-labelledby":`${n.name}-tab`},[ot(r.$slots,"default")],10,Vd)],8,Od)}var G=k(jd,[["render",Ad]]);const Bd={inject:["util"],name:"SyntaxContent",components:{TabContent:G},props:{parser:H,view:String},data(){return{dateExample:this.parser.dateTimeHelper.formatDate(new Date,this.parser.options.dateFormat).slice(0,-5)}}},Hd=e("h3",{class:"fw-light"},"Timelog Syntax",-1),zd=e("p",null,"Timelog properties are attached by using certain prefix characters. Properties will be suggested ordered by how often they are used. ",-1),Nd=e("p",null,[u("On a device with physical keyboard, use "),e("kbd",null,"up"),u(" and "),e("kbd",null,"down"),u(" to navigate the suggestions, "),e("kbd",null,"enter"),u(" or "),e("kbd",null,"tab"),u(" to insert the highlighted suggestion.")],-1),qd=e("h3",null,[e("code",null,[e("kbd",null,"@"),u("client")])],-1),Yd=e("p",null,[u("Use the "),e("code",null,"@"),u(" symbol to add one or more clients to a timelog. Clients will be suggested based on past timelogs. You can toggle the "),e("code",null,"client"),u("-column in the settings and set a default client to be used when no client is given.")],-1),Kd=e("h3",null,[e("code",null,[e("kbd",null,"%"),u("project")])],-1),Qd=e("p",null,[u("Use the "),e("code",null,"%"),u(" symbol to add one or more projects to a timelog. Projects will be suggested based on past timelogs. You can toggle the "),e("code",null,"project"),u("-column in the settings and set a default project to be used when no project is given.")],-1),Jd=e("h3",null,[e("code",null,[e("kbd",null,"#"),u("task")])],-1),Wd=e("p",null,[u("Use the "),e("code",null,"#"),u(" symbol to add one or more tasks to a timelog. Tasks will be suggested based on past timelogs. You can toggle the "),e("code",null,"tasks"),u("-column in the settings and set a default task to be used when no task is given.")],-1),Gd=e("h3",null,[e("code",null,[e("kbd",null,"/"),u("source")])],-1),Zd=e("p",null,[u("Use the "),e("code",null,"/"),u(" symbol to add one or more sources to a timelog. Sources will be suggested based on past timelogs. You can toggle the "),e("code",null,"sources"),u("-column in the settings and set a default source to be used when no source is given.")],-1),Xd=e("h3",null,[e("code",null,[e("kbd",null,"+"),u("1:30")]),u(" (duration)")],-1),tc=e("p",null,[u("Use the "),e("code",null,"+"),u(" symbol to add a duration to the timelog. When omitted, the default duration setting will be used. When you give a single digit value below the "),e("code",null,"hourThreshold"),u(" setting, the input will be converted to hours. You can toggle the "),e("code",null,"duration"),u("-column in the settings.")],-1),ec=e("kbd",null,":",-1),sc=u(" (date)"),nc=e("p",null,[u("Use the "),e("code",null,":"),u(" symbol to add a date to the timelog. When omitted, the current date setting will be used. There are several shortcuts like "),e("code",null,":-2"),u(", "),e("code",null,":lasttue"),u(". ")],-1),oc=e("h3",null,[e("code",null,[e("kbd",null,"$"),u("1234")]),u(" (rate)")],-1),ic=e("p",null,[u("Use the "),e("code",null,"$"),u(" symbol to add a custom rate to the timelog. When omitted, the default rate setting will be used. You can toggle the "),e("code",null,"cost"),u("-column in the settings.")],-1),rc=e("h3",null,"Multiple Logs",-1),ac=e("p",null,[u("Use "),e("kbd",null,"----"),u(" (4x dash) to separate multiple logs. On store, each timelog will be created individually.")],-1),lc=e("h3",null,"Multiple Logs, Extend Mode",-1),dc=e("p",null,[u("Use "),e("kbd",null,"****"),u(" (4x asterik) to separate multiple logs. On store, each timelog will be created individually but each one inherits the properties from the first log unless specified inside the current log. This is useful for example when you did the same task for multiple clients, so you only have to write it once, then append "),e("code",null,"****@client2****@client3..."),u(" to create the identical logs for different clients. ")],-1),cc=e("p",{class:"bg-dark p-2"},[u("Note You can't mix "),e("code",null,"----"),u(" and "),e("code",null,"****"),u(", use either.")],-1),uc=e("h3",null,[e("code",null,[e("kbd",null,"!"),u("log")]),u(" (copy)")],-1),hc=e("p",null,[u("Copy an existing log with "),e("kbd",null,"!"),u(" as the first character. Use either the row number of the current view or a leading part of a hash. All properties after the the recall code are used on the copy. If no "),e("kbd",null,":date"),u(" is given, the current default date is used. If you want to copy the same log on the original date use "),e("kbd",null,"!!"),u(" (two exclamation marks). ")],-1),pc=e("h3",null,[u("Timers"),e("kbd",null,"&")],-1),mc=e("p",null,[u(" Add an "),e("code",null,"&"),u(" at the end of a timelog to create timer instead of storing the timelog instantly. "),e("br"),u(" Timers are not synced! ")],-1),gc=e("h3",null,"Everything else",-1),fc=e("p",null,"Everything that isn't matched as a property is considered as description and will be used as such.",-1);function _c(r,t,n,a,s,o){const i=v("TabContent");return l(),A(i,{name:"help",view:n.view},{default:O(()=>[Hd,zd,Nd,qd,Yd,Kd,Qd,Jd,Wd,Gd,Zd,Xd,tc,e("h3",null,[e("code",null,[ec,u(p(s.dateExample),1)]),sc]),nc,e("p",null,[e("a",{href:"#",onClick:t[0]||(t[0]=y(c=>r.$emit("set-view","dateparse"),["stop","prevent"]))},"More on Date and Duration")]),oc,ic,e("p",null,[e("a",{href:"#",onClick:t[1]||(t[1]=y(c=>r.$emit("set-view","parsetest"),["stop","prevent"]))},"Explore parser behaviour")]),rc,ac,lc,dc,cc,uc,hc,pc,mc,gc,fc]),_:1},8,["view"])}var bc=k(Bd,[["render",_c]]);const yc={name:"TabButton",props:{name:String,view:String}},wc={class:"nav-item",role:"presentation"},vc=["id","aria-controls","aria-selected"];function kc(r,t,n,a,s,o){return l(),d("li",wc,[e("button",{class:I(["nav-link",{active:n.view===n.name}]),id:`${n.name}-tab`,type:"button",role:"tab","aria-controls":`${n.name}TabsPane`,"aria-selected":n.view===n.name,onClick:t[0]||(t[0]=i=>r.$emit("set-view",n.name))},[ot(r.$slots,"default")],10,vc)])}var xc=k(yc,[["render",kc]]);const Sc={name:"SyncContent",components:{TabContent:G},props:{view:String}},Dc=e("h3",{class:"fw-light"},"Synchronization",-1),Cc=e("p",null," Synchronization enables time tracking across multiple devices/platforms and provides a good way to have a backup of your timelogs in the cloud. ",-1),Tc=e("p",null," Data is stored with strong encryption (AES-GCM) and no server side data processing whatsoever. The synchronization of your data across devices is handled by each device independently, so differences in the order of timelogs within a day might occur. ",-1),Ic=e("p",null,[u(" Online storage currently piggybacks off "),e("a",{href:"https://www.xbrowsersync.org/",target:"_blank",rel:"noopener"},"xBrowserSync's"),u(" API servers but you can create your own instance using their "),e("a",{href:"https://github.com/xbrowsersync/api",target:"_blank",rel:"noopener"},"API code"),u(". ")],-1),$c=e("p",null,[u(" Please make sure you use a good and "),e("u",null,"unique"),u(" password, since there is no way to recover the password in case you lose it. The password will be stored in "),e("u",null,"plain text"),u(" in your browser's local storage which is accessible by anyone who has access to your device, so ensure that you do NOT use it for any other service. ")],-1),Lc=e("p",null," Synchronization relies on built-in features of the browser (Cryptography, Compression) that may not be available in certain engines or older versions. Some Blink/Webkit-based browser with a recent build number is recommended! ",-1);function Fc(r,t,n,a,s,o){const i=v("TabContent");return l(),A(i,{name:"synchronization",view:n.view},{default:O(()=>[Dc,Cc,Tc,Ic,$c,Lc]),_:1},8,["view"])}var Rc=k(Sc,[["render",Fc]]);const Mc={name:"DateparseContent",components:{TabContent:G},inject:["util"],props:{view:String,parser:H},data(){return{dd:this.parser.options.defaultDuration,ht:this.parser.options.hourThreshold,durations:["","+1.06","+1:05","+1:50","+0:30","+0.5","+10","+2","+2.5","+2:30","+10","+.5","+45"],dates:["",":t",":today",":y",":yesterday",":05",":5",":50",":-1",":-3",":+1",":+2",":mon",":fri",":lastwed",":nexttue",":"+this.parser.dateTimeHelper.convertFormattedString("22.01","dd.mm.yyyy",this.parser.options.dateFormat).slice(0,-5),":"+this.parser.dateTimeHelper.convertFormattedString("11.12","dd.mm.yyyy",this.parser.options.dateFormat).slice(0,-5),":"+this.parser.dateTimeHelper.convertFormattedString("10.03.2022","dd.mm.yyyy",this.parser.options.dateFormat)]}}},Ec=e("h3",{class:"fw-light"},"Dates",-1),Uc=u("Dates are parsed from the configured date format ("),Pc=u(") and several shortcuts:"),jc={class:"table duration-examples"},Oc=e("thead",null,[e("tr",null,[e("th",null,"value"),e("th",null,"parsed date")])],-1),Vc=e("h3",{class:"fw-light"},"Durations",-1),Ac=e("p",null,[u("Durations are parsed to minutes and displayed in "),e("code",null,"hh:mm"),u(" format:")],-1),Bc={class:"table duration-examples"},Hc=e("thead",null,[e("tr",null,[e("th",null,"value"),e("th",null,"parsed minutes"),e("th",null,"hh:mm")])],-1);function zc(r,t,n,a,s,o){const i=v("TabContent");return l(),A(i,{name:"dateparse",view:n.view},{default:O(()=>[Ec,e("p",null,[Uc,e("code",null,p(n.parser.options.dateFormat),1),Pc]),e("table",jc,[Oc,e("tbody",null,[(l(!0),d($,null,F(s.dates,(c,h)=>(l(),d("tr",null,[e("td",null,[e("code",null,p(c)+" "+p(c===""?"(empty)":""),1)]),e("td",null,p(o.util.formatDate(n.parser.dateTimeHelper.parseDate(c,n.parser.options.dateFormat),n.parser.options.dateFormat)),1)]))),256))])]),Vc,Ac,e("table",Bc,[Hc,e("tbody",null,[(l(!0),d($,null,F(s.durations,(c,h)=>(l(),d("tr",null,[e("td",null,[e("code",null,p(c)+" "+p(c===""?"(empty)":""),1)]),e("td",null,p(n.parser.dateTimeHelper.parseDuration(c,s.dd,s.ht)),1),e("td",null,p(o.util.formatDuration(n.parser.dateTimeHelper.parseDuration(c,s.dd,s.ht))),1)]))),256))])])]),_:1},8,["view"])}var Nc=k(Mc,[["render",zc]]);const qc={name:"ParsetestContent",components:{TabContent:G},inject:["util"],props:{view:String,parser:H},data(){return{options:this.parser.options,logString:"",parsed:this.parser.decoratedParse(""),examples:{empty:"",full:"@acme %relaunch #support /jira:ACRL-1842 +93 :-2 $99 summarize how aspect ratio works",sparse:"@acme #support /phone determine how many edges a rectangle has",multi:"@acme @designcompany #concept #planning %relaunch %refactoring :-2 +3 discuss framework upgrade"}}},watch:{logString:function(){this.parsed=this.parser.decoratedParse(this.logString)}}},Yc=e("h3",{class:"fw-light"},"Parse Test",-1),Kc={class:"small"},Qc=u(" Examples: "),Jc=["onClick"],Wc={class:"table"},Gc=e("thead",null,[e("tr",null,[e("th",null," property "),e("th",null," matched "),e("th",null," is default ")])],-1),Zc=e("td",null,[e("code",null,"@client")],-1),Xc=e("td",null,[e("code",null,"%project")],-1),tu=e("td",null,[e("code",null,"#task")],-1),eu=e("td",null,[e("code",null,"/source")],-1),su=e("td",null,[e("code",null,"+duration")],-1),nu=e("td",null,[e("code",null,":date")],-1),ou=e("td",null,[e("code",null,"$rate")],-1),iu=e("td",null,[e("code",null,"(cost)")],-1),ru=e("td",null," n/a ",-1),au=e("td",null,[e("code",null,"description")],-1),lu=e("td",null," n/a ",-1),du=e("td",null,[e("code",null,"normalized")],-1),cu={colspan:"2"},uu=e("td",null,[e("code",null,"is timer")],-1),hu={colspan:"2"};function pu(r,t,n,a,s,o){const i=v("TabContent");return l(),A(i,{name:"parsetest",view:n.view},{default:O(()=>[Yc,m(e("textarea",{ref:"ta",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=c=>s.logString=c)},null,512),[[w,s.logString]]),e("div",Kc,[Qc,(l(!0),d($,null,F(s.examples,(c,h)=>(l(),d("a",{href:"#",class:"me-1",onClick:y(_=>s.logString=c,["stop","prevent"])},p(h),9,Jc))),256))]),e("table",Wc,[Gc,e("tbody",null,[e("tr",null,[Zc,e("td",null,p(o.util.join(s.parsed.clients,"")),1),e("td",null,p(s.parsed.usesDefaultClient?"yes":"no"),1)]),e("tr",null,[Xc,e("td",null,p(o.util.join(s.parsed.projects,"")),1),e("td",null,p(s.parsed.usesDefaultProject?"yes":"no"),1)]),e("tr",null,[tu,e("td",null,p(o.util.join(s.parsed.tasks,"")),1),e("td",null,p(s.parsed.usesDefaultTask?"yes":"no"),1)]),e("tr",null,[eu,e("td",null,p(o.util.join(s.parsed.sources,"")),1),e("td",null,p(s.parsed.usesDefaultSource?"yes":"no"),1)]),e("tr",null,[su,e("td",null,p(o.util.formatDuration(s.parsed.duration)),1),e("td",null,p(s.parsed.usesDefaultDuration?"yes":"no"),1)]),e("tr",null,[nu,e("td",null,p(o.util.formatDate(s.parsed.timestamp,s.options.dateFormat)),1),e("td",null,p(s.parsed.usesDefaultDate?"yes":"no"),1)]),e("tr",null,[ou,e("td",null,p(o.util.formatCost(s.parsed.rate,s.options.currencyFormat)),1),e("td",null,p(s.parsed.usesDefaultRate?"yes":"no"),1)]),e("tr",null,[iu,e("td",null,p(o.util.formatCost(o.util.costFromRate(s.parsed.duration,s.parsed.rate),s.options.currencyFormat)),1),ru]),e("tr",null,[au,e("td",null,p(s.parsed.description),1),lu]),e("tr",null,[du,e("td",cu,[e("code",null,p(s.parsed.normalized),1)])]),e("tr",null,[uu,e("td",hu,[e("code",null,p(s.parsed.isTimer?"yes":"no"),1)])])])])]),_:1},8,["view"])}var mu=k(qc,[["render",pu]]);const gu={name:"HelpDialog",components:{ParsetestContent:mu,DateparseContent:Nc,SyncContent:Rc,TabButton:xc,SyntaxContent:bc},props:{parser:H},data(){return{modal:null,view:"help"}},mounted(){this.modal=new B(this.$refs.modal)},methods:{show(r="help"){this.view=r,this.modal.show()},setView(r){this.view=r}}},fu={class:"modal fade",ref:"modal",id:"helpHowTo","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"helpHowToLabel","aria-hidden":"true"},_u={class:"modal-dialog modal-lg modal-dialog-scrollable modal-fullscreen-md-down"},bu={class:"modal-content"},yu=e("div",{class:"modal-header"},[e("h5",{class:"modal-title fw-light",id:"helpHowToLabel"},"Help & Howto "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),wu={class:"modal-body"},vu={class:"nav nav-tabs",id:"helpTabs",role:"tablist"},ku=u("Syntax"),xu=u("Date and Duration"),Su=u("Synchronization"),Du=u("Parse Test");function Cu(r,t,n,a,s,o){const i=v("TabButton"),c=v("SyntaxContent"),h=v("DateparseContent"),_=v("SyncContent"),g=v("ParsetestContent");return l(),d("div",fu,[e("div",_u,[e("div",bu,[yu,e("div",wu,[e("ul",vu,[D(i,{name:"help",view:s.view,onSetView:o.setView},{default:O(()=>[ku]),_:1},8,["view","onSetView"]),D(i,{name:"dateparse",view:s.view,onSetView:o.setView},{default:O(()=>[xu]),_:1},8,["view","onSetView"]),D(i,{name:"synchronization",view:s.view,onSetView:o.setView},{default:O(()=>[Su]),_:1},8,["view","onSetView"]),D(i,{name:"parsetest",view:s.view,onSetView:o.setView},{default:O(()=>[Du]),_:1},8,["view","onSetView"])]),D(c,{view:s.view,onSetView:o.setView,parser:n.parser},null,8,["view","onSetView","parser"]),D(h,{view:s.view,parser:n.parser},null,8,["view","parser"]),D(_,{view:s.view},null,8,["view"]),D(g,{view:s.view,parser:n.parser},null,8,["view","parser"])])])])],512)}var Tu=k(gu,[["render",Cu]]);const Iu={},$u={xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},Lu=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1),Fu=[Lu];function Ru(r,t){return l(),d("svg",$u,Fu)}var Mu=k(Iu,[["render",Ru]]);const Eu={},Uu={xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},Pu=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"},null,-1),ju=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1),Ou=[Pu,ju];function Vu(r,t){return l(),d("svg",Uu,Ou)}var Au=k(Eu,[["render",Vu]]);const Bu={},Hu={xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},zu=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"},null,-1),Nu=[zu];function qu(r,t){return l(),d("svg",Hu,Nu)}var Yu=k(Bu,[["render",qu]]);const Ku={emits:["end-timer"],components:{DeleteLog:at,CheckMark:Yu,PlayButton:Au,PauseButton:Mu},inject:["util","settings"],props:{timers:tt,logParser:H},data(){return{refreshKey:0,timeout:null}},watch:{timers:{deep:!0,handler:function(){this.timeout===null&&this.increaseKey()}}},mounted(){this.timeout=setTimeout(this.increaseKey,6e4)},methods:{increaseKey(){this.refreshKey++,this.timers.timers.length>0?this.timeout=setTimeout(this.increaseKey,6e4):this.timeout=null}}},Qu={class:"me-1"},Ju={key:0,class:"me-1"},Wu={key:1,class:"me-1"},Gu={key:2,class:"me-1"},Zu={key:3,class:"me-1"},Xu={key:4,class:"me-1"},th={key:5,class:"me-1"},eh=["onClick"],sh=["onClick"],nh=["onClick"];function oh(r,t,n,a,s,o){const i=v("PauseButton"),c=v("PlayButton"),h=v("CheckMark"),_=v("DeleteLog");return l(),d("div",{key:s.refreshKey},[(l(!0),d($,null,F(n.timers.timers,(g,C)=>(l(),d("div",{class:I(["alert mt-3 p-2 d-flex justify-content-between",{"alert-info":g.state==="running","alert-warning":g.state!=="running"}])},[e("div",null,[e("strong",Qu,p(o.util.formatDuration(g.state==="running"?n.timers.duration(g.started)+g.minutes:g.minutes)),1),g.timelog.clients.length>0?(l(),d("span",Ju,p(o.util.join(g.timelog.clients,"@")),1)):f("",!0),g.timelog.projects.length>0?(l(),d("span",Wu,p(o.util.join(g.timelog.projects,"%")),1)):f("",!0),g.timelog.tasks.length>0?(l(),d("span",Gu,p(o.util.join(g.timelog.tasks,"#")),1)):f("",!0),g.timelog.sources.length>0?(l(),d("span",Zu,p(o.util.join(g.timelog.sources,"/")),1)):f("",!0),g.timelog.description.length>0?(l(),d("span",Xu,p(g.timelog.description),1)):f("",!0),o.settings.showCostColumn?(l(),d("strong",th,p(o.util.formatAmount(o.util.costFromRate(n.timers.duration(g.started)+g.minutes,g.timelog.rate),o.settings.currencyFormat)),1)):f("",!0)]),e("div",{class:I(["btn-group",{pulse:g.state==="running"}]),role:"group"},[e("button",{class:I(["btn py-1 btn-icon",{"btn-outline-info":g.state==="running","btn-outline-warning":g.state!=="running"}]),onClick:y(U=>n.timers.toggle(C),["stop","prevent"])},[g.state==="running"?(l(),A(i,{key:0})):(l(),A(c,{key:1}))],10,eh),e("button",{class:I(["btn py-1 btn-icon",{"btn-outline-info":g.state==="running","btn-outline-warning":g.state!=="running"}]),onClick:y(U=>r.$emit("end-timer",n.timers.end(C)),["stop","prevent"])},[D(h)],10,sh),e("button",{class:I(["btn py-1 btn-icon",{"btn-outline-info":g.state==="running","btn-outline-warning":g.state!=="running"}]),onClick:y(U=>n.timers.delete(C),["stop","prevent"])},[D(_)],10,nh)],2)],2))),256))])}var ih=k(Ku,[["render",oh]]);const rh={filenameTemplate:"Timelogs %s",dateFormat:"dd.mm.yyyy",dateRangeFormat:"dd.mm?.yyyy? - dd.mm.yyyy",closeFiltersOnApply:!0,checkForUpdateIntervalMinutes:10,storeOnControlEnter:!0,clearTimeLogOnStore:!0,showParsePreviewOnType:!0,keepOriginalLogOnEdit:!1,defaultDuration:30,hourThreshold:5,defaultRate:255,currencyFormat:"%s \u20AC",rateIncludesTax:!0,tax:0,showCostColumn:!0,showProjectColumn:!0,showSourceColumn:!0,showClientColumn:!0,showTaskColumn:!0,showDupeButton:!0,defaultClient:"",defaultProject:"",defaultTask:"",defaultSource:"",deviceName:null,deviceId:null,syncEnabled:!0,syncSettings:!0,defaultView:"month",showHelpIcon:!0,defaultDateInsideSelection:!0,syncAfterSeconds:30,syncOnLoad:!0,showIndexColumn:!0};class dt{constructor(){x(this,"dateTimeHelper");this.dateTimeHelper=new rt}defaultDates(){const t=new Date(2022,11,29).toLocaleDateString().replace("2022","yyyy").replace("22","yy").replace("12","mm").replace("29","dd"),n=t.replace("yyyy","yyyy?").replace("mm","mm?")+" - "+t;return{defaultDateFormat:t,defaultDateRangeFormat:n}}join(t,n="",a="n/a"){return t.length===0?a:(n+t.join(", "+n)).trim()}copyToClipboard(t,n){const a=document.createElement("textarea");a.classList.add("position-absolute","opacity-0","start-0","top-0"),n.insertAdjacentElement("afterend",a),a.value=t,a.focus(),a.select(),document.execCommand("copy"),a.blur(),a.remove()}escapeRegExp(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}round(t,n=2){return Math.round(t*Math.pow(10,n))/Math.pow(10,n)}formatDateRangeByFormat(t,n,a){return this.dateTimeHelper.formatRange(t,n,a)}formatDate(t,n="yyyy-mm-dd"){return this.dateTimeHelper.formatDate(t,n)}floatHoursFromMinutes(t){const n=Math.floor(t/60),a=(t-n*60)/60;return n+a}formatDuration(t){const n=Math.floor(t/60),a=t-n*60;return`${n}:${("0"+a).slice(-2)}`}costFromRate(t,n){return this.floatHoursFromMinutes(t)*n}formatAmount(t,n){const a=new Intl.NumberFormat(void 0,{style:"currency",currency:"USD"}).format(t).replace(/\s.*$/,"").replace(/[^\d.',-]/g,"");return n.replace("%s",a)}formatCost(t,n,a=0,s=!1){if(a===0)return this.formatAmount(this.round(t),n);let o;const i=a*.01;s?o=t-t/(1+i):(o=t*i,t+=o);const c=this.formatAmount(this.round(t),n),h=this.formatAmount(this.round(o),n);return`${c} <small>(incl ${h} tax)</small>`}formatBytes(t,n=2){if(t===0)return"0 Bytes";const a=1024,s=n<0?0:n,o=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(t)/Math.log(a));return parseFloat((t/Math.pow(a,i)).toFixed(s))+" "+o[i]}hash(t){return globalThis.crypto&&"getRandomValues"in globalThis.crypto?Array.from(globalThis.crypto.getRandomValues(new Uint8Array(t))).map(n=>("0"+n.toString(16)).slice(-2)).join(""):require("crypto").randomBytes(t).toString("hex")}dateRange(t,n){let[a,s,o]=n.split("-").map(C=>parseInt(C)),i=new Date(a,s-1,o);i.setMilliseconds(0);let c,h=new Date(i),_=new Date(i),g=new Date(i);return t==="month"?(h.setDate(1),h.setHours(0),h.setMinutes(0),h.setSeconds(0),c=new Date(h),c.setMonth(h.getMonth()+1),c.setSeconds(-1),_.setMonth(_.getMonth()+1),g.setMonth(g.getMonth()-1)):(h.setDate(h.getDate()-h.getDay()+1),h.setHours(0),h.setMinutes(0),h.setSeconds(0),c=new Date(h),c.setDate(h.getDate()+7),c.setSeconds(-1),_.setDate(_.getDate()+7),g.setDate(g.getDate()-7)),{upper:c,lower:h,upperUS:this.formatDate(c),lowerUS:this.formatDate(h),next:`${_.getFullYear()}-${("0"+(_.getMonth()+1)).slice(-2)}-${("0"+_.getDate()).slice(-2)}`,prev:`${g.getFullYear()}-${("0"+(g.getMonth()+1)).slice(-2)}-${("0"+g.getDate()).slice(-2)}`}}escapeStringForFilename(t,n="-"){return[34,60,62,124,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,58,42,63,92,47].forEach(a=>{const s=String.fromCharCode(a);for(;t.indexOf(s)>-1;)t=t.replace(s,n)}),t}}const ct=it("settings",{state:()=>{const r=new Y,{defaultDateFormat:t,defaultDateRangeFormat:n}=new dt().defaultDates();return r.get("settings",N(j({},rh),{dateFormat:t,dateRangeFormat:n}))},actions:{update(r,t){this[r]=t}}});const ah={inject:["util","globalStore","settings"],components:{TimerList:ih,HelpDialog:Tu,ImportExportDialog:bd,ImportSyncCredentialsFromURLDialog:Pd,SyncOptionsDialog:ss,SettingsDialog:ho,ToastBox:No,LogTable:ll,InputBox:Di,LoadingModal:gl,TopBar:$l,OffCanvasMenu:Xo,InspectDialog:Po},data(){const r=new Y,t=new H(N(j({},ct()),{util:this.util})),n=new q(t,{deviceId:this.settings.deviceId,util:this.util,storeFunction:this.store.bind(this),storage:r}),a=new K(n);return{syncIsRunning:!1,suggestionProvider:a,timelogStore:n,storage:r,parser:t,sync:new z(r),timers:new tt(r,t)}},mounted(){this.timelogStore.checkIntegrity(),new URL(window.location).searchParams.has("encryptedSyncCredentials")&&this.$refs.importFromURL.show(),/h=([\w]+)/.test(window.location.hash)&&(this.$refs.help.show(/h=([\w]+)/.exec(window.location.hash)[1]),window.location.hash=""),this.settings.syncEnabled&&this.sync.hasCredentials&&this.syncIfNeeded(!0,this.settings.syncOnLoad)},watch:{settings:{deep:!0,handler:function(){Object.keys(this.parser.options).forEach(r=>{r in this.settings&&(this.parser.options[r]=this.settings[r])})}}},methods:{afterInsert(){this.settings.syncAfterSeconds>0&&(this.clearSyncTimeout(),this.syncIsRunning=!0,this.syncTimeout=setTimeout(this.syncIfNeeded.bind(this),this.settings.syncAfterSeconds*1e3))},enableSync(){!this.syncIsRunning&&this.sync.hasCredentials&&(this.globalStore.toast("sync enabled"),this.syncIfNeeded(!0))},syncIfNeeded(r=!1,t=!1){this.sync.needsUpdate().then(n=>{n||t?this.sync.load().then(a=>{if(!a){this.globalStore.setLoading(!1);return}if(a&&"settings"in a&&a.settings.syncSettings===!0){let s=0;for(const o in a.settings)o!=="deviceName"&&o!=="deviceId"&&this.settings[o]!==a.settings[o]&&(this.settings[o]=a.settings[o],s++);s>0&&this.globalStore.toast("settings synced")}if(a&&"transactions"in a){const s=this.timelogStore.mergeTransactions(a.transactions);s>0&&this.globalStore.toast(`synced ${s} transactions...`),this.suggestionProvider.rebuild()}this.$refs.logTable.updateTableData(),this.timelogStore.currentTransaction&&this.store()}):this.timelogStore.currentTransaction&&this.store(),r&&this.globalStore.toast("synced...")}).catch(n=>{this.globalStore.toast("sync",n)}),this.setSyncTimeout()},clearSyncTimeout(){clearTimeout(this.syncTimeout),this.syncTimeout=null},setSyncTimeout(){const r=this.settings.checkForUpdateIntervalMinutes;if(this.clearSyncTimeout(),Math.abs(r)===0||!this.settings.syncEnabled){console.log("disabling sync"),this.syncIsRunning=!1;return}console.log("setting timeout for "+r+" minutes..."),this.syncIsRunning=!0,this.syncTimeout=setTimeout(this.syncIfNeeded.bind(this),r*60*1e3)},store(){!this.settings.syncEnabled||!this.sync.hasCredentials||(this.globalStore.setLoading(!0),this.timelogStore.commit(!0),this.sync.store({transactions:this.timelogStore.transactions,settings:this.settings.$state}).then(r=>{this.globalStore.setLoading(!1),this.globalStore.toast(`${this.util.formatBytes(r.encrypted)} (${this.util.formatBytes(r.original)}) uploaded`)}).catch(r=>{console.log(r)}))},syncNow(){this.syncIfNeeded(!0,!0),setTimeout(this.store.bind(this),2500)},logFromTimer(r){this.timelogStore.insert(r),this.$refs.logTable.updateTableData(),this.globalStore.toast("created log from timer...")}}},lh={class:"container"};function dh(r,t,n,a,s,o){const i=v("TopBar"),c=v("InputBox"),h=v("TimerList"),_=v("LogTable"),g=v("SettingsDialog"),C=v("HelpDialog"),U=v("SyncOptionsDialog"),b=v("InspectDialog"),L=v("ImportExportDialog"),S=v("ImportSyncCredentialsFromURLDialog"),M=v("ToastBox"),V=v("OffCanvasMenu");return l(),d($,null,[D(i),e("div",lh,[D(c,{ref:"input",parser:s.parser,"log-store":s.timelogStore,"suggestion-provider":s.suggestionProvider,timers:s.timers,onShowHelp:t[0]||(t[0]=P=>r.$refs.help.show("help")),onReloadTable:t[1]||(t[1]=P=>r.$refs.logTable.updateTableData()),onAfterInsert:o.afterInsert},null,8,["parser","log-store","suggestion-provider","timers","onAfterInsert"]),s.timers.timers.length>0?(l(),A(h,{key:0,timers:s.timers,"log-parser":s.parser,onEndTimer:o.logFromTimer},null,8,["timers","log-parser","onEndTimer"])):f("",!0),D(_,{ref:"logTable","log-store":s.timelogStore,"log-parser":s.parser,"suggestion-provider":s.suggestionProvider,onHideSuggestions:t[2]||(t[2]=P=>r.$refs.input.unsetSuggestions()),onEditLog:t[3]||(t[3]=P=>r.$refs.input.editLog(P))},null,8,["log-store","log-parser","suggestion-provider"])]),D(g,{ref:"settings",storage:s.storage,sync:s.sync,onEnableSync:o.enableSync},null,8,["storage","sync","onEnableSync"]),D(C,{ref:"help",parser:s.parser},null,8,["parser"]),D(U,{ref:"syncOptions",sync:s.sync},null,8,["sync"]),D(b,{ref:"inspect","timelog-store":s.timelogStore},null,8,["timelog-store"]),D(L,{ref:"importExport","timelog-store":s.timelogStore,sync:s.sync,"suggestion-provider":s.suggestionProvider},null,8,["timelog-store","sync","suggestion-provider"]),D(S,{ref:"importFromURL",sync:s.sync},null,8,["sync"]),D(M),D(V,{sync:s.sync,onShowSettings:t[4]||(t[4]=P=>r.$refs.settings.show()),onShowSyncOptions:t[5]||(t[5]=P=>r.$refs.syncOptions.show()),onInspectData:t[6]||(t[6]=P=>r.$refs.inspect.show()),onShowImportDialog:t[7]||(t[7]=P=>r.$refs.importExport.show()),onSyncNow:t[8]||(t[8]=P=>o.syncNow()),onShowHelpDialog:t[9]||(t[9]=P=>r.$refs.help.show())},null,8,["sync"])],64)}var ch=k(ah,[["render",dh],["__scopeId","data-v-2f02fcf5"]]);const uh=it("globalStore",{state:()=>({toasts:[],loading:!1,defaultDate:null,upperDate:null,lowerDate:null}),actions:{toast(r,t,n=2e3){this.toasts.push({title:r,body:t}),setTimeout(()=>{this.toasts.shift()},n)},toggleLoading(){this.loading=!this.loading},setLoading(r=!0){this.loading=r}}}),Q=xt(ch);Q.use(St());const ut=new dt,hh=uh(),E=ct();Q.provide("util",ut);Q.provide("globalStore",hh);Q.provide("settings",E);E.$subscribe(()=>{const r=new Y,t=j({},E.$state);r.set("settings",t)},{detached:!0});"showIndexColumn"in E||E.$patch({showIndexColumn:!1});"syncOnLoad"in E||E.$patch({syncOnLoad:!0});"syncAfterSeconds"in E||E.$patch({syncAfterSeconds:30});"showHelpIcon"in E||E.$patch({showHelpIcon:!0});"defaultDateInsideSelection"in E||E.$patch({defaultDateInsideSelection:!0});if(!E.deviceId){E.deviceId=ut.hash(16);const r=new Dt.exports.UAParser().getResult();E.deviceName=`${r.browser.name} on ${r.os.name} ${r.os.version} (${r.cpu.architecture})`}Q.mount("#app");
